function isFunction(a){return"[object Function]"===Object.prototype.toString.call(a)}function isArray(a){return"[object Array]"===Object.prototype.toString.call(a)}function rand(a,b){return Math.random()*(b-a+1)+a}function irand(a,b){return Math.floor(rand(a,b))}function isObject(a){return"[object Object]"===Object.prototype.toString.call(a)}function createImage(){return window.Image?new Image:ce("img")}function trim(a){return(a||"").replace(/^\s+|\s+$/g,"")}function stripHTML(a){return a?a.replace(/<(?:.|\s)*?>/g,""):""}function escapeRE(a){return a?a.replace(/([.*+?^${}()|[\]\/\\])/g,"\\$1"):""}function unicodeEscape(a){return a.replace(/[\s\S]/g,function(a){var b=a.charCodeAt().toString(16),c=b.length>2;return"\\"+(c?"u":"x")+("0000"+b).slice(c?-4:-2)})}function addslashes(a){return(a+"").replace(/[\\"']/g,"\\$&").replace(/\u0000/g,"\\0")}function intval(a){return a===!0?1:parseInt(a)||0}function floatval(a){return a===!0?1:parseFloat(a)||0}function positive(a){return a=intval(a),a<0?0:a}function isEmpty(a){if("[object Object]"!==Object.prototype.toString.call(a))return!1;for(var b in a)if(a.hasOwnProperty(b))return!1;return!0}function Now(){return+new Date}function indexOf(a,b,c){for(var d=c||0,e=(a||[]).length;d<e;d++)if(a[d]==b)return d;return-1}function inArray(a,b){return indexOf(b,a)!=-1}function each(a,b){var c,d=0,e=a.length;if(void 0===e){for(c in a)if(b.call(a[c],c,a[c])===!1)break}else for(var f=a[0];d<e&&b.call(f,d,f)!==!1;f=a[++d]);return a}function extend(){var a,b=arguments,c=b[0]||{},d=1,e=b.length,f=!1;for("boolean"==typeof c&&(f=c,c=b[1]||{},d=2),"object"==typeof c||isFunction(c)||(c={});d<e;++d)if(null!=(a=b[d]))for(var g in a){var h=c[g],i=a[g];c!==i&&(f&&i&&"object"==typeof i&&!i.nodeType?c[g]=extend(f,h||(null!=i.length?[]:{}),i):void 0!==i&&(c[g]=i))}return c}function winToUtf(a){var b,c,d;b=a.match(/&#[0-9]{2}[0-9]*;/gi);for(c in b){var e=""+b[c];d=intval(e.substr(2,e.length-3)),d>=32&&"&#"+d+";"==e&&(a=a.replace(e,String.fromCharCode(d)))}return a.replace(/&quot;/gi,'"').replace(/&lt;/gi,"<").replace(/&gt;/gi,">").replace(/&amp;/gi,"&")}function clone(a,b){var c=isArray(a)?[]:{};for(var d in a)(!browser.webkit||"layerX"!=d&&"layerY"!=d)&&(b&&"object"==typeof a[d]&&"prototype"!==d?c[d]=clone(a[d]):c[d]=a[d]);return c}function attachScript(a,b,c){var d,e=(b.substr(b.indexOf("/")+1,b.indexOf(".")-b.indexOf("/")+2).replace(/[\/\.]/g,"_"),[]);for(var f in reqs)d=reqs[f],d&&(0==d.running?(ge("req"+d.num).parentNode.removeChild(ge("req"+d.num)),reqs[f]=null):e[f]=d);reqs=e;var g=ce("script",{id:a,type:"text/javascript",src:(/^http:\/\//i.test(b)||/^\//i.test(b)?"":base_domain)+b});c&&(g.onreadystatechange=c,g.onload=c),headNode.appendChild(g)}function destroy(){reqs[this.num]&&(reqs[this.num].running=0)}function addCss(a){var b=a.substr(a.indexOf("/")+1,a.indexOf(".")-a.indexOf("/")-1)+"_css";ge(b)||headNode.appendChild(ce("link",{type:"text/css",rel:"stylesheet",href:base_domain+a+(css_versions[b]?"?"+css_versions[b]:""),id:b,media:"screen"}))}function debugLog(a){console.log(a)}function addEvent(a,b,c,d,e){if(a=ge(a),a&&3!=a.nodeType&&8!=a.nodeType){/mousewheel/.test(b)&&(b+=" DOMMouseScroll"),(/outclick/.test(b)||/outpress/.test(b))&&(b=b.replace("outclick","mousedown"),b=b.replace("outpress","keypress keydown"),c=eventOut.set(a,c),a=document);var f=e?function(){var a=function(a){var b=a.data;a.data=e;var d=c.apply(this,[a]);return a.data=b,d};return a.handler=c,a}():c;a.setInterval&&a!=window&&(a=window);var g=data(a,"events")||data(a,"events",{}),h=data(a,"handle")||data(a,"handle",function(){_eventHandle.apply(arguments.callee.elem,arguments)});h.elem=a,each(b.split(/\s+/),function(b,c){g[c]||(g[c]=[],!d&&a.addEventListener?a.addEventListener(c,h,!1):!d&&a.attachEvent&&a.attachEvent("on"+c,h)),g[c].push(f)}),a=null}}function removeEvent(a,b,c){if(a=ge(a)){(/outclick/.test(b)||/outpress/.test(b))&&(b=b.replace("outclick","mousedown"),b=b.replace("outpress","keypress keydown"),c=eventOut.get(c),eventOut.del(c),a=document);var d=data(a,"events");if(d)if("string"==typeof b)/mousewheel/.test(b)&&(b+=" DOMMouseScroll"),each(b.split(/\s+/),function(b,e){if(isArray(d[e])){var f=d[e].length;if(isFunction(c)){for(var g=f-1;g>=0;g--)if(d[e][g]&&(d[e][g]===c||d[e][g].handler===c)){d[e].splice(g,1),f--;break}}else{for(var g=0;g<f;g++)delete d[e][g];f=0}f||(a.removeEventListener?a.removeEventListener(e,data(a,"handle"),!1):a.detachEvent&&a.detachEvent("on"+e,data(a,"handle")),delete d[e])}}),isEmpty(d)&&(removeData(a,"events"),removeData(a,"handle"));else for(var e in d)removeEvent(a,e)}}function triggerEvent(a,b,c,d){a=ge(a);var e=data(a,"handle");if(e){var f=function(){e.call(a,extend(c||{},{type:b,target:a}))};d?f():setTimeout(f,0)}}function cancelEvent(a){if(a=a||window.event,!a)return!1;for(;a.originalEvent;)a=a.originalEvent;return a.preventDefault&&a.preventDefault(),a.stopPropagation&&a.stopPropagation(),a.cancelBubble=!0,a.returnValue=!1,!1}function removeData(a,b){var c=!!a&&a[eventExpand];if(c)if(b){if(eventCache[c]){delete eventCache[c][b],b="";var d=0;for(b in eventCache[c])if("__elem"!==b){d++;break}d||removeData(a)}}else removeEvent(a),removeAttr(a,eventExpand),delete eventCache[c]}function cleanElems(){for(var a=arguments,b=0;b<a.length;++b){var c=ge(a[b]);c&&(removeData(c),removeAttr(c,"btnevents"))}}function data(a,b,c){var d,e=a[eventExpand];return e||(e=a[eventExpand]=++eventUUID),c!==d&&(eventCache[e]||(eventCache[e]={},eventDebugMode&&(eventCache[e].__elem=a)),eventCache[e][b]=c),b?eventCache[e]&&eventCache[e][b]:e}function removeAttr(a){for(var b=0,c=arguments.length;b<c;++b){var d=arguments[b];if(void 0!==a[d])try{delete a[d]}catch(b){try{a.removeAttribute(d)}catch(a){}}}}function _eventHandle(a){a=normEvent(a);var b=data(this,"events");if(b&&"string"==typeof a.type&&b[a.type]&&b[a.type].length)for(var c in b[a.type]||[]){if("mouseover"==a.type||"mouseout"==a.type){for(var d=a.relatedElement;d&&d!=this;)try{d=d.parentNode}catch(a){d=this}if(d==this)continue}var e=b[a.type][c].apply(this,arguments);if(e!==!1&&e!==-1||cancelEvent(a),e===-1)return!1}}function normEvent(a){a=a||window.event;var b=a;if(a=clone(b),a.originalEvent=b,a.target||(a.target=a.srcElement||document),3==a.target.nodeType&&(a.target=a.target.parentNode),!a.relatedTarget&&a.fromElement&&(a.relatedTarget=a.fromElement==a.target),null==a.pageX&&null!=a.clientX){var c=document.documentElement,d=bodyNode;a.pageX=a.clientX+(c&&c.scrollLeft||d&&d.scrollLeft||0)-(c.clientLeft||0),a.pageY=a.clientY+(c&&c.scrollTop||d&&d.scrollTop||0)-(c.clientTop||0)}return!a.which&&(a.charCode||0===a.charCode?a.charCode:a.keyCode)&&(a.which=a.charCode||a.keyCode),!a.metaKey&&a.ctrlKey?a.metaKey=a.ctrlKey:!a.ctrlKey&&a.metaKey&&browser.mac&&(a.ctrlKey=a.metaKey),!a.which&&a.button&&(a.which=1&a.button?1:2&a.button?3:4&a.button?2:0),"mousewheel"!==a.type&&"wheel"!==a.type&&"DOMMouseScroll"!==a.type||!a.wheelDelta&&!a.detail||(a.wheelDelta=a.detail=(a.wheelDelta?a.wheelDelta/120:a.detail/-3)>0?1:-1),a}function onCtrlEnter(a,b){a=a||window.event,(10==a.keyCode||13==a.keyCode&&(a.ctrlKey||a.metaKey&&browser.mac))&&(b(),cancelEvent(a))}function press(a,b){return a.keyCode==KEY[b]}function getTarget(a){return a.srcElement||a.target}function supportsSvg(){try{return document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#Shape","1.0")}catch(a){}return!1}function ge(a){return"string"==typeof a||"number"==typeof a?document.getElementById(a):a}function geByClass(a,b,c){b=b||document,c=c||"*";var d=[];if(!browser.msie8&&b.querySelectorAll&&"*"!=c)return b.querySelectorAll(c+"."+a);if(b.getElementsByClassName){var e=b.getElementsByClassName(a);if("*"!=c){c=c.toUpperCase();for(var f=0,g=e.length;f<g;++f)e[f].tagName.toUpperCase()==c&&d.push(e[f])}else d=Array.prototype.slice.call(e);return d}for(var h=geByTag(c,b),i=new RegExp("(^|\\s)"+a+"(\\s|$)"),f=0,g=h.length;f<g;++f)i.test(h[f].className)&&d.push(h[f]);return d}function geByClass1(a,b,c){return b=b||document,c=c||"*",!browser.msie8&&b.querySelector&&b.querySelector(c+"."+a)||geByClass(a,b,c)[0]}function geByTag(a,b){return(b||document).getElementsByTagName(a)}function geByTag1(a,b){return b=b||document,b.querySelector&&b.querySelector(a)||geByTag(a,b)[0]}function ce(a,b,c){var d=document.createElement(a);return b&&extend(d,b),c&&setStyle(d,c),d}function re(a){return a=ge(a),a&&a.parentNode&&a.parentNode.removeChild(a),a}function hasClass(a,b){return a=ge(a),a&&new RegExp("(\\s|^)"+b+"(\\s|$)").test(a.className)}function addClass(a,b){(a=ge(a))&&!hasClass(a,b)&&(a.className=(a.className?a.className+" ":"")+b)}function removeClass(a,b){(a=ge(a))&&(a.className=trim((a.className||"").replace(new RegExp("(\\s|^)"+b+"(\\s|$)")," ")))}function toggleClass(a,b,c){void 0===c&&(c=!hasClass(a,b)),(c?addClass:removeClass)(a,b)}function replaceClass(a,b,c){removeClass(a,b),addClass(a,c)}function getStyle(a,b,c){if(a=ge(a),isArray(b)){var d={};return each(b,function(b,c){d[c]=getStyle(a,c)}),d}if(void 0===c&&(c=!0),!c&&"opacity"==b&&browser.msie){var e=a.style.filter;return e?e.indexOf("opacity=")>=0?parseFloat(e.match(/opacity=([^)]*)/)[1])/100+"":"1":""}if(!c&&a.style&&(a.style[b]||"height"==b))return a.style[b];var f,g=document.defaultView||window;if(g.getComputedStyle){b=b.replace(/([A-Z])/g,"-$1").toLowerCase();var h=g.getComputedStyle(a,null);h&&(f=h.getPropertyValue(b))}else if(a.currentStyle){if("opacity"==b&&browser.msie){var e=a.currentStyle.filter;return e&&e.indexOf("opacity=")>=0?parseFloat(e.match(/opacity=([^)]*)/)[1])/100+"":"1"}var i=b.replace(/\-(\w)/g,function(a,b){return b.toUpperCase()});if(f=a.currentStyle[b]||a.currentStyle[i],"auto"==f&&(f=0),!/^\d+(px)?$/i.test(f)&&/^\d/.test(f)){var j=a.style,k=j.left,l=a.runtimeStyle.left;a.runtimeStyle.left=a.currentStyle.left,j.left=f||0,f=j.pixelLeft+"px",j.left=k,a.runtimeStyle.left=l}}if(c&&("width"==b||"height"==b)){var m=getSize(a,!0)[{width:0,height:1}[b]];f=(intval(f)?Math.max(floatval(f),m):m)+"px"}return f}function setStyle(a,b,c){if(a=ge(a)){if("object"==typeof b)return each(b,function(b,c){setStyle(a,b,c)});if("opacity"==b)browser.msie&&((c+"").length?1!==c?a.style.filter="alpha(opacity="+100*c+")":a.style.filter="":a.style.cssText=a.style.cssText.replace(/filter\s*:[^;]*/gi,""),a.style.zoom=1),a.style.opacity=c;else try{var d="number"==typeof c;d&&/height|width/i.test(b)&&(c=Math.abs(c)),a.style[b]=d&&!/z-?index|font-?weight|opacity|zoom|line-?height/i.test(b)?c+"px":c}catch(a){console.log([b,c])}}}function str2hash(a){for(var b=5381,c=0;c<a.length;c++)b=(b<<5)+b+a.charCodeAt(c);return b}function str2color(a){var b=str2hash(a),c=(16711680&b)>>16,d=(65280&b)>>8,e=255&b;return"#"+("0"+c.toString(16)).substr(-2)+("0"+d.toString(16)).substr(-2)+("0"+e.toString(16)).substr(-2)}function getRGB(a){var b;return a&&isArray(a)&&3==a.length?a:(b=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(a))?[parseInt(b[1]),parseInt(b[2]),parseInt(b[3])]:(b=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(a))?[2.55*parseFloat(b[1]),2.55*parseFloat(b[2]),2.55*parseFloat(b[3])]:(b=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(a))?[parseInt(b[1],16),parseInt(b[2],16),parseInt(b[3],16)]:(b=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(a))?[parseInt(b[1]+b[1],16),parseInt(b[2]+b[2],16),parseInt(b[3]+b[3],16)]:void 0}function getColor(a,b){var c;do{if(c=getStyle(a,b),""!=c&&"transparent"!=c||"body"==a.nodeName.toLowerCase())break;b="backgroundColor"}while(a=a.parentNode);return getRGB(c)}function animate(a,b,c,d){if(a=ge(a)){var e,f=isFunction(d)?d:function(){},g=extend({},"object"==typeof c?c:{duration:c,onComplete:f}),h={},i={},j=isVisible(a);g.orig={},b=clone(b),b.discrete&&(g.discrete=1,delete b.discrete),browser.iphone&&(g.duration=0);var k=data(a,"tween"),l=j?"hide":"show";k&&k.isTweening&&(g.orig=extend(g.orig,k.options.orig),k.stop(!1),k.options.show?l="hide":k.options.hide&&(l="show"));for(e in b){if(!k&&("show"==b[e]&&j||"hide"==b[e]&&!j))return g.onComplete.call(this,a);if("height"!=e&&"width"!=e||!a.style||(b.overflow||(void 0==g.orig.overflow&&(g.orig.overflow=getStyle(a,"overflow")),a.style.overflow="hidden"),hasClass(a,"inl_bl")||"TD"==a.tagName||(a.style.display="block")),/show|hide|toggle/.test(b[e]))if("toggle"==b[e]&&(b[e]=l),"show"==b[e]){var m=0;g.show=!0,void 0==g.orig[e]&&(g.orig[e]=getStyle(a,e,!1)||"",setStyle(a,e,0));var n;"height"==e&&browser.msie6?(n="0px",a.style.overflow=""):n=g.orig[e];var o=a.style[e];a.style[e]=n,b[e]=parseFloat(getStyle(a,e,!0)),a.style[e]=o,"height"==e&&browser.msie&&!b.overflow&&(a.style.overflow="hidden")}else void 0==g.orig[e]&&(g.orig[e]=getStyle(a,e,!1)||""),g.hide=!0,b[e]=0}return g.show&&!j&&show(a),k=new Fx.Base(a,g),each(b,function(b,c){if(/backgroundColor|borderBottomColor|borderLeftColor|borderRightColor|borderTopColor|color|borderColor|outlineColor/.test(b)){var d="borderColor"==b?"borderTopColor":b;m=getColor(a,d),c=getRGB(c)}else{var e=c.toString().match(/^([+-]=)?([\d+-.]+)(.*)$/);k.cur(b,!0)||0;e&&(c=parseFloat(e[2]),e[1]&&(c=("-="==e[1]?-1:1)*c+c)),g.hide&&"height"==b&&browser.msie6&&(a.style.height="0px",a.style.overflow=""),m=k.cur(b,!0),g.hide&&"height"==b&&browser.msie6&&(a.style.height="",a.style.overflow="hidden"),0!=m||"width"!=b&&"height"!=b||(m=1),"opacity"==b&&c>0&&!j&&(setStyle(a,"opacity",0),m=0,show(a))}(m!=c||isArray(m)&&m.join(",")==c.join(","))&&(h[b]=m,i[b]=c)}),k.start(h,i),data(a,"tween",k),k}}function fadeTo(a,b,c,d){return animate(a,{opacity:c},b,d)}function genFx(a,b){var c={};return each(Fx.Attrs.concat.apply([],Fx.Attrs.slice(0,b)),function(){c[this]=a}),c}function getXY(a){if(a=ge(a),!a)return[0,0];var b,c,d=0,e=0;if(a.offsetParent)do d+=c=a.offsetLeft,e+=a.offsetTop,b=getStyle(a,"position"),"fixed"!=b&&"absolute"!=b&&"relative"!=b||(d-=a.scrollLeft,e-=a.scrollTop,"fixed"==b&&(d+=(a.offsetParent||{}).scrollLeft||document.body.scrollLeft||document.documentElement.scrollLeft,e+=(a.offsetParent||{}).scrollTop||document.body.scrollTop||document.documentElement.scrollTop));while(a=a.offsetParent);return[d,e]}function getSize(a,b){function c(){if(d=[a.offsetWidth,a.offsetHeight],b){each(d,function(b,c){var e=b?["Top","Bottom"]:["Left","Right"];each(e,function(){d[b]-=parseFloat(getStyle(a,"padding"+this))||0,d[b]-=parseFloat(getStyle(a,"border"+this+"Width"))||0})}),d=[Math.round(d[0]),Math.round(d[1])]}}a=ge(a);var d=[0,0],e=document.documentElement;if(a==document)d=[Math.max(e.clientWidth,bodyNode.scrollWidth,e.scrollWidth,bodyNode.offsetWidth,e.offsetWidth),Math.max(e.clientHeight,bodyNode.scrollHeight,e.scrollHeight,bodyNode.offsetHeight,e.offsetHeight)];else if(a)if(isVisible(a))c();else{var f={position:"absolute",visibility:"hidden",display:"block"},g={};each(f,function(b,c){g[b]=a.style[b],a.style[b]=c}),c(),each(f,function(b,c){a.style[b]=g[b]})}return d}function getPosition(a){for(var b=0,c=0;a.offsetParent;)b+=a.offsetLeft,c+=a.offsetTop,a=a.offsetParent;return b+=a.offsetLeft,c+=a.offsetTop,[b,c]}function getMouseOffset(a,b){var c=getPosition(b||a.target);return[a.pageX-c[0],a.pageY-c[1]]}function elfocus(a,b,c){a=ge(a);try{if(a.focus(),void 0!==b&&b!==!1||(b=a.value.length),void 0!==c&&c!==!1||(c=b),a.createTextRange){var d=a.createTextRange();d.collapse(!0),d.moveEnd("character",c),d.moveStart("character",b),d.select()}else a.setSelectionRange&&a.setSelectionRange(b,c)}catch(a){}}function scrollGetY(){return intval(window.pageYOffset)||document.documentElement.scrollTop}function scrollGetX(){return window.pageXOffset||document.documentElement.scrollLeft}function getScroll(){var a=document.body,b=document.documentElement;return[a.scrollLeft||b.scrollLeft||window.pageXOffset||0,a.scrollTop||b.scrollTop||window.pageYOffset||0,b.clientWidth||a.clientWidth||0,b.clientHeight||a.clientHeight||0]}function windowSize(){return[windowWidth(),windowHeight()]}function windowHeight(){return window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:document.body.offsetHeight}function windowWidth(){return window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:document.body.offsetWidth}function show(a){if(arguments.length>1)for(var b=0,c=arguments.length;b<c;++b)show(arguments[b]);else if(a=ge(a),a&&a.style){var d=a.olddisplay,e="block",f=a.tagName.toLowerCase();a.style.display=d||"","none"==getStyle(a,"display")&&(e=hasClass(a,"inline")?"inline":"tr"!=f||browser.msie?"table"!=f||browser.msie?"block":"table":"table-row",a.style.display=a.olddisplay=e)}}function hide(a){var b=arguments.length;if(b>1)for(var c=0;c<b;c++)hide(arguments[c]);else if(a=ge(a),a&&a.style){var d=getStyle(a,"display");a.olddisplay="none"!=d?d:"",a.style.display="none"}}function isVisible(a){return a=ge(a),!(!a||!a.style)&&"none"!=getStyle(a,"display")}function toggle(a,b){void 0===b&&(b=!isVisible(a)),b?show(a):hide(a)}function placeholderSetup(a){var b=ge(a);if(b){if(browser.opera&&browser.mobile)return b.getValue=function(){return b.value},void(b.setValue=function(a){b.value=a});var c=b.getAttribute("placeholder");!b.phevents&&c&&""!=c&&(b.active=1,b.value&&b.value!=c||b.focused||(b.style.color="#777",b.value=c,b.active=0),addEvent(b,"focus",function(){b.active||(b.active=1,b.value="",b.style.color="#000")}),addEvent(b,"blur",function(){b.active&&c&&""==b.value&&(b.active=0,b.style.color="#777",b.value=c)}),b.getValue=function(){return b.active||b.value!=c?b.value:""},b.setValue=function(a){b.active=a?1:0,b.value=a?a:c,b.style.color=a?"#000":"#777"},b.phevents=1)}}function boxRefreshCoords(a,b){var c=windowSize(),d=scrollGetY(),e=getSize(a);a.style.top=Math.max(0,d+(c[1]-e[1])/3)+"px",b&&(a.style.left=Math.max(0,(c[0]-e[0])/2)+"px")}function BGLayer(){ge("popupTransparentBG")||(window.transparentBG=ce("div",{id:"popupTransparentBG",className:"popup_transparent_bg"},{display:"none",height:getSize(document)[1]}),addEvent(window,"resize",function(){transparentBG.style.height=getSize(document)[1]+"px"}),onDomReady(function(){bodyNode.appendChild(transparentBG)}))}function sbWidth(){return 16}function notaBene(a,b,c){if(a=ge(a)){c||elfocus(a),void 0===data(a,"backstyle")&&data(a,"backstyle",a.style.backgroundColor||"");var d=data(a,"back")||data(a,"back",getStyle(a,"backgroundColor")),e={notice:"#FFFFE0",warning:"#FAEAEA"};setStyle(a,"backgroundColor",e[b]||b||e.warning),setTimeout(animate.pbind(a,{backgroundColor:d},300,function(){a.style.backgroundColor=data(a,"backstyle")}),400)}}function doGetCaretPosition(a){a=ge(a);var b=0;if(document.selection){a.focus();var c=document.selection.createRange();c.moveStart("character",-a.value.length),b=c.text.length}else(a.selectionStart||"0"==a.selectionStart)&&(b=a.selectionStart);return b}function setCaretPosition(a,b){if(a=ge(a),a.setSelectionRange)a.focus(),a.setSelectionRange(b,b);else if(a.createTextRange){var c=a.createTextRange();c.collapse(!0),c.moveEnd("character",b),c.moveStart("character",b),c.select()}return!0}function se(a){return ce("div",{innerHTML:a}).firstChild}function rs(a,b){return each(b,function(b,c){a=a.replace(new RegExp("%"+b+"%","g"),c)}),a}function val(a,b,c){if(a=ge(a))return void 0!==b&&(a.setValue?(a.setValue(b),!c&&a.phonblur&&a.phonblur()):"INPUT"==a.tagName||"TEXTAREA"==a.tagName?a.value=b:a.innerHTML=b),a.getValue?a.getValue():("INPUT"==a.tagName||"TEXTAREA"==a.tagName?a.value:a.innerHTML)||""}function domEL(a,b){for(b=b?"previousSibling":"nextSibling";a&&!a.tagName;)a=a[b];return a}function domNS(a){return domEL((a||{}).nextSibling)}function domPS(a){return domEL((a||{}).previousSibling,1)}function domFC(a){return domEL((a||{}).firstChild)}function domLC(a){return domEL((a||{}).lastChild,1)}function domPN(a){return(a||{}).parentNode}function onMousePast(a,b){var c={obj:ge(a),test:function(a){a!==c.obj&&(a.parentNode?c.test(a.parentNode):(isFunction(b)&&b(),c.hide()))},detect:function(a){c.test(a.target)},show:function(){addEvent(document,"keypress keydown mousedown",c.detect)},hide:function(){removeEvent(document,"keypress keydown mousedown",c.detect)}};return c}function scrollToY(a,b,c){void 0==b&&(b=400);var d="ontouchstart"in document.documentElement;if(d&&(b=0),browser.msie6?data(bodyNode,"tween")&&data(bodyNode,"tween").stop(!1):(data(bodyNode,"tween")&&data(bodyNode,"tween").stop(!1),data(htmlNode,"tween")&&data(htmlNode,"tween").stop(!1)),window.scrollAnimation=!1,b){var e=function(){window.scrollAnimation=!1};window.scrollAnimation=!0,browser.msie6?animate(bodyNode,{scrollTop:a},b,e):(animate(htmlNode,{scrollTop:a,transition:Fx.Transitions.easeInCirc},b,e),animate(bodyNode,{scrollTop:a,transition:Fx.Transitions.easeInCirc},b,e))}else{if(c&&2!==c){var f=scrollGetY()-a;return Math.abs(f)>6&&scrollToY(a+(f>0?6:-6),0,2),clearTimeout(window.scrlToTO),void(window.scrlToTO=setTimeout(scrollToY.pbind(a,100,2),0))}window.scroll(scrollGetX(),a),browser.msie6&&(bodyNode.scrollTop=a)}}function scrollToTop(a){return scrollToY(0,a)}function ajx2q(a){var b=[],c=function(a){if(window._decodeEr&&_decodeEr[a])return a;try{return encodeURIComponent(a)}catch(b){return a}};for(var d in a)if(null!=a[d]&&!isFunction(a[d]))if(isArray(a[d]))for(var e=0,f=0,g=a[d].length;e<g;++e)null==a[d][e]||isFunction(a[d][e])||(b.push(c(d)+"["+f+"]="+c(a[d][e])),++f);else b.push(c(d)+"="+c(a[d]));return b.sort(),b.join("&")}function q2ajx(a){if(!a)return{};var b={},c=function(a){try{return decodeURIComponent(a)}catch(b){return window._decodeEr=window._decodeEr||{},_decodeEr[a]=1,a}};return a=a.split("&"),each(a,function(a,d){var e=d.split("=");if(e[0]){var f=c(e[1]+"");if("[]"==e[0].substr(e.length-2)){var g=c(e[0].substr(0,e.length-2));b[g]||(b[g]=[]),b[g].push(f)}else b[c(e[0])]=f}}),b}function Jsonp(a,b,c){function d(){h||(delete JsonpCallbackRegister[i],f(a))}var e,f,g="string"!=typeof b?ajx2q(b):b,h=!1,i="f"+String(Math.random()).slice(2);c||(c={}),isFunction(c)?e=c:(e=c.onSuccess,f=c.onFail),a+=~a.indexOf("?")?"&":"?",a+="callback=JsonpCallbackRegister."+i,a+="&"+g,JsonpCallbackRegister[i]=function(a){h=!0,delete JsonpCallbackRegister[i],e(a)};var j=document.createElement("script");j.type="text/javascript",j.async=!0,j.setAttribute("encoding","UTF-8"),j.onreadystatechange=function(){"complete"!=this.readyState&&"loaded"!=this.readyState||(this.onreadystatechange=null,setTimeout(d,0))},j.onload=j.onerror=d,j.src=a,document.getElementsByTagName("head")[0].appendChild(j)}function langNumeric(a,b,c){if(!b)return a;var d;if(isArray(b)?(d=b[1],a!=Math.floor(a)?d=b[2]:each([[100,[11,12,13,14],3],[10,[1],1],[10,[2,3,4],2],["*",0,3]],function(c,e){if("*"==e[0])return d=b[e[2]],!1;var f=e[0]?a%e[0]:a;return indexOf(e[1],f)!=-1?(d=b[e[2]],!1):void 0})):d=b,c){for(var e=a.toString().split("."),f=[],g=e[0].length-3;g>-3;g-=3)f.unshift(e[0].slice(g>0?g:0,g+3));e[0]=f.join(langConfig.numDel),a=e.join(langConfig.numDec)}return d=(d||"%s").replace("%s",a)}function langSex(a,b){if(!isArray(b))return b;var c=b[1];return each([[1,2],["*",1]],function(d,e){return"*"==e[0]?(c=b[e[1]],!1):a==e[0]&&b[e[1]]?(c=b[e[1]],!1):void 0}),c}function langKeyNotFound(a){console.log(a)}function getLang(){try{var a=Array.prototype.slice.call(arguments),b=a.shift();if(!b)return"...";var c=window.lang&&window.lang[b]||window.langpack&&window.langpack[b]||window[b];return c?isFunction(c)?c.apply(null,a):void 0!==a[0]||isArray(c)?langNumeric(a[0],c,a[1]):c:(langKeyNotFound(b),b.split("-").join(" "))}catch(a){debugLog("lang error:"+a.message+"("+Array.prototype.slice.call(arguments).join(", ")+")")}}function writeLang(a){if(!a)return document.write("...");var b=window.lang&&window.lang[a]||window.langpack&&window.langpack[a]||window[a];if(!b){var c=a.split("-");return document.write("≠"+c.join(" "))}return document.write(b)}function parseLatin(a,b){var c,d=a,e=["y","yo","zh","kh","ts","ch","sch","shch","sh","eh","yu","ya","YO","ZH","KH","TS","CH","SCH","SHCH","SH","EH","YU","YA","'"],f=["ий","ё","ж","х","ц","ч","щ","щ","ш","э","ю","я","Ё","Ж","Х","Ц","Ч","Щ","Щ","Ш","Э","Ю","Я","ь"];for(c=0;c<e.length;c++)d=b?d.split(f[c]).join(e[c]):d.split(e[c]).join(f[c]);var g="abvgdeziyklmnoprstufhcyABVGDEZIJKLMNOPRSTUFHCYёЁ",h="абвгдезийклмнопрстуфхцыАБВГДЕЗИЙКЛМНОПРСТУФХЦЫеЕ";for(c=0;c<g.length;c++)d=b?d.split(h.charAt(c)).join(g.charAt(c)):d.split(g.charAt(c)).join(h.charAt(c));return b?d==a?a:d:a}function highlight(a,b){if(a+="",b+="",""==b)return a;a=b.indexOf(" ")==-1?a.split(" "):[a];var c="",d=parseLatin(b);null!==d&&(b=escapeRE(b)+"|"+escapeRE(d));var e=new RegExp("(?![^&;]+;)(?!<[^<>]*)((\\(*)("+b+"))(?![^<>]*>)(?![^&;]+;)","gi");for(var f in a)c+=(f>0?" ":"")+a[f].replace(e,"$2<em>$3</em>");return c}function inherit(a,b){var c=function(){};c.prototype=b.prototype,a.prototype=new c,a.prototype.constructor=a,a.superclass=b.prototype}function createChildClass(className,parent,proto){var code="function "+className+" (a, b, c, d) {    if (this == window || this.setInterval) return new "+className+'(a, b, c, d);    this.__className = "'+className+'";    return this.__construct__(arguments);  };';window.execScript?window.execScript(code):window.eval(code);var childClass=eval("("+className+")");inherit(childClass,parent),"common"in proto&&(extend(childClass,proto.common),proto.common=childClass),extend(childClass.prototype,proto)}function UiControl(a){return this.__construct__(a)}function createUiClass(a,b){return createChildClass(a,UiControl,b)}function UiUtil(a){return this.__construct__(a)}function createUtilClass(a,b){return createChildClass(a,UiUtil,b)}function JsClass(a){return this.__construct__(a)}function createClass(a,b){return createChildClass(a,JsClass,b)}function createButton(a,b){if(a=ge(a),a&&!a.btnevents){if(hasClass(a,"flat_button"))return void(isFunction(b)&&(a.onclick=b.pbind(a)));var c=a.parentNode;if(hasClass(c,"button_blue")||hasClass(c,"button_gray"))return void(isFunction(b)&&(a.onclick=b.pbind(a)));var d=!1;addEvent(a,"click mousedown mouseover mouseout",function(e){if(!hasClass(c,"locked"))switch(e.type){case"click":if(!d)return;return a.className="button_hover",b(a),cancelEvent(e);case"mousedown":a.className="button_down";break;case"mouseover":d=!0,a.className="button_hover";break;case"mouseout":a.className="button",d=!1}}),a.btnevents=!0}}function lockButton(a){if(a=ge(a)){if(hasClass(a,"flat_button"))return void lockFlatButtonNew(a);var b="button"==a.tagName.toLowerCase(),c=b?0:browser.msie6||browser.msie7?2:4,d=b?a:geByClass1("file_button_text",a);if((b||hasClass(a,"file_button"))&&!buttonLocked(a)){var e=ce("span",{className:"button_lock"});a.parentNode.insertBefore(e,a),a.old_width=a.style.width,a.old_height=a.style.height;var f=getSize(a.parentNode);setStyle(a,{width:f[0]-c,height:f[1]-c}),browser.msie6||browser.msie7?(d.old_html=d.innerHTML,d.innerHTML=""):d.style.textIndent="-9999px"}}}function unlockButton(a){if(a=ge(a)){if(hasClass(a,"flat_button"))return void unlockFlatButtonNew(a);var b=geByClass1("button_lock",a.parentNode,"span"),c="button"==a.tagName.toLowerCase(),d=c?a:geByClass1("file_button_text",a);b&&(a.parentNode.removeChild(b),a.style.width=a.old_width,a.style.height=a.old_height,(browser.msie6||browser.msie7)&&(d.innerHTML=d.old_html),d.style.textIndent="")}}function buttonLocked(a){if(a=ge(a))return hasClass(a,"flat_button")?isButtonLocked(a):!!geByClass1("button_lock",a.parentNode,"span")}function lockFlatButton(a){a&&"button"==a.tagName.toLowerCase()&&!isButtonLocked(a)&&(addClass(a,"flat_btn_lock"),a.innerHTML='<span class="flat_btn_h">'+a.innerHTML+"</span>")}function unlockFlatButton(a){isButtonLocked(a)&&(a.innerHTML=a.firstChild.innerHTML,removeClass(a,"flat_btn_lock"))}function isButtonLocked(a){if(a=ge(a))return hasClass(a,"flat_btn_lock")}function disableButton(a,b){if((a=ge(a))&&"button"===a.tagName.toLowerCase()){if(hasClass(a,"flat_button"))return disableFlatButton(a,b);if(toggleClass(a.parentNode,"button_disabled",!!b),b)a.parentNode.insertBefore(ce("button",{innerHTML:a.innerHTML,className:"disabled"}),a),hide(a);else{var c=geByClass1("disabled",a.parentNode);c&&re(c),show(a)}}}function disableFlatButton(a,b){if((a=ge(a))&&"button"===a.tagName.toLowerCase())if(b)a.parentNode.insertBefore(ce("button",{innerHTML:a.innerHTML,className:a.className+" button_disabled"},{width:getSize(a)[0]+"px"}),a),hide(a);else{var c=domPS(a);c&&hasClass(c,"button_disabled")&&re(c),show(a)}}function lockFlatButtonNew(a){(a=ge(a))&&"button"===a.tagName.toLowerCase()&&(a.parentNode.insertBefore(ce("button",{innerHTML:'<span class="flat_btn_h">'+a.innerHTML+"</span>",className:a.className+" flat_btn_lock"},{width:getSize(a)[0]+"px"}),a),hide(a))}function unlockFlatButtonNew(a){if((a=ge(a))&&"button"===a.tagName.toLowerCase()&&isButtonLockedNew(a)){var b=domPS(a);b&&hasClass(b,"flat_btn_lock")&&re(b),show(a)}}function isButtonLockedNew(a){if((a=ge(a))&&"button"===a.tagName.toLowerCase()){var b=domPS(a);return b&&hasClass(b,"flat_btn_lock")}}function getShownBox(){try{var a=_message_boxes[_message_box_shown];return!(!a||!a.isVisible)&&a}catch(a){return!1}}function AlertBox(a,b,c,d){var e=new MessageBox({title:a});return"object"==typeof d?e.setOptions(d):d={},e.removeButtons(),"CONFIRM"==d.boxType?(e.addButton({label:d.no||getLang("global-no"),style:"button_no",onClick:function(){e.hide()}}),e.addButton({label:d.yes||getLang("global-yes"),onClick:function(){isFunction(c)&&c()===!1||e.hide()}})):e.addButton({label:d.no||getLang("global-close"),onClick:function(){e.hide(),isFunction(c)&&c()}}),e.content(b).show()}function ConfirmBox(a,b,c,d){return d=d||{},d=extend({boxType:"CONFIRM"},d),AlertBox(a,b,c,d)}function Popup(a,b){b=extend({type:"POPUP",width:420,dark:!0},b);var c=new MessageBox(b);c.content(a),c.show()}function showBox(a,b,c,d,e,f,g){if("object"==typeof d&&(e=d.reload,f=d.params,g=d.files,d=d.href),d&&window.event&&(2==window.event.which||1==window.event.button))return!0;if(f=extend({title:getLang("global-loading")},f),winBoxes[a])e&&winBoxes[a].setOptions(f);else if(winBoxes[a]=new MessageBox(f),e=!0,g)for(var h in g)/\.css/i.test(g[h])?addCss(g[h]):/\.js/i.test(g[h])&&attachScript("script"+h,g[h]);return e&&(winBoxes[a].removeButtons(),winBoxes[a].addButton({label:getLang("global-close"),onClick:function(){winBoxes[a].hide()}}),winBoxes[a].loadContent(b,c,!1)),winBoxes[a].show(),!1}function showBalloonBox(a,b){b=extend({width:240,onHide:void 0,onConfirm:void 0,center:!1,left:!1,timeout:5e3,permit:void 0,check_global_permit:!0},b);var c,d=ce("div",{className:"result_balloon_item_fly_area cf"+(b.center?" result_balloon_center":""),innerHTML:'<div style="width: '+b.width+'px" class="result_balloon_item cf"><div class="result_balloon_item_message fl" style="width: '+(b.onConfirm?b.width-20+"px":"auto")+'">'+a+'</div><div class="result_balloon_confirm_button fr"></div></div>'}),e=0,f=function(a){a=!!a,setTimeout(function(){return isFunction(b.permit)&&!b.permit()||b.check_global_permit&&balloon_global_permit&&!a?void f():void animate(d,b.center?{top:e-10,opacity:0}:{marginTop:-10,opacity:0},200,function(){re(d),isFunction(b.onHide)&&b.onHide()})},a?0:b.timeout)};if(b.center)c=bodyNode;else{var g="result_balloon_wrap_"+(b.left?"left":"right");c=ge(g),c||(c=ce("div",{id:g}),addEvent(c,"mouseover mouseout",function(a){balloon_global_permit="mouseover"==a.type}),bodyNode.appendChild(c))}if(c.appendChild(d),b.center){var h=windowSize(),i=getSize(d);e=h[1]/3-i[1]/2,setStyle(d,{left:h[0]/2-i[0]/2,top:e})}if(animate(d,b.center?{top:e-5,opacity:1}:{marginTop:0,opacity:1},300),isFunction(b.onConfirm)){b.timeout=0,b.onHide=b.onConfirm;var j=geByClass1("result_balloon_confirm_button",d);j.style.display="block",addEvent(j,"click",function(){f(!0)})}else f()}function showDoneBox(a,b){b=extend({center:!0},b),b.w&&(b.width=b.w),b.out&&(b.timeout=b.out),b.callback&&(b.onHide=b.callback),showBalloonBox(a,b)}function showBandBox(a,b){b=extend({},b),b.w&&(b.width=b.w),b.out&&(b.timeout=b.out),b.callback&&(b.onHide=b.callback),showBalloonBox(a,b);
}function showMessage(a,b,c){b=b||MESSAGE_ERROR,c=extend({width:240},c);var d='<div class="balloon_message_box cf"><div class="message_icon message_type_'+b+' fl"></div><div class="message_text fl" style="width:'+(c.width-50)+'px">'+a+"</div></div>";showBalloonBox(d,c)}function Dropdown(a,b,c){return c||(c={}),new Selector(a,c.autocomplete?b:[],extend({introText:"",multiselect:!1,autocomplete:!1,selectedItems:c.selectedItem},c,{defaultItems:b}))}function Autocomplete(a,b,c){return new Selector(a,b,c)}function Radiobuttons(a,b,c){var d=a.id;Radiobutton._radio_buttons[d]=[],Radiobutton._callbacks[d]=[],each(b,function(a,b){new Radiobutton(ge(d+b[0]),{label:b[1],width:c.width,resultField:d})}),Radiobutton.select(d,void 0!==c.selected?c.selected:a.value),Radiobutton.setChangeEvent(d,function(b){a.value=b,isFunction(c.onChange)&&c.onChange(b)})}var base_domain=location.protocol+"//"+location.host,_ua=navigator.userAgent.toLowerCase(),lang=lang||{},rtl=!1,parseJSON=window.JSON&&JSON.parse?function(obj){try{return JSON.parse(obj)}catch(e){try{return eval("("+obj+")")}catch(a){return!1}}}:function(obj){try{return eval("("+obj+")")}catch(a){return!1}};void 0==window.console&&(window.console={log:function(a){},info:function(a){},warn:function(a){},error:function(a){},time:function(){},timeEnd:function(){}});var browser={version:(_ua.match(/.+(?:me|ox|on|rv|it|era|ie)[\/: ]([\d.]+)/)||[0,"0"])[1],opera:/opera/i.test(_ua),msie:/msie/i.test(_ua)&&!/opera/i.test(_ua),msie6:/msie 6/i.test(_ua)&&!/opera/i.test(_ua),msie7:/msie 7/i.test(_ua)&&!/opera/i.test(_ua),msie8:/msie 8/i.test(_ua)&&!/opera/i.test(_ua),msie9:/msie 9/i.test(_ua)&&!/opera/i.test(_ua),mozilla:/firefox/i.test(_ua),chrome:/chrome/i.test(_ua),safari:!/chrome/i.test(_ua)&&/webkit|safari|khtml/i.test(_ua),iphone:/iphone/i.test(_ua),ipod:/ipod/i.test(_ua),iphone4:/iphone.*OS 4/i.test(_ua),ipod4:/ipod.*OS 4/i.test(_ua),ipad:/ipad/i.test(_ua),android:/android/i.test(_ua),bada:/bada/i.test(_ua),mobile:/iphone|ipod|ipad|opera mini|opera mobi|iemobile/i.test(_ua),msie_mobile:/iemobile/i.test(_ua),safari_mobile:/iphone|ipod|ipad/i.test(_ua),opera_mobile:/opera mini|opera mobi/i.test(_ua),opera_mini:/opera mini/i.test(_ua),mac:/mac/i.test(_ua),webkit:/webkit/i.test(_ua),search_bot:/(yandex|google|stackrambler|aport|slurp|msnbot|bingbot|twitterbot|ia_archiver|facebookexternalhit)/i.test(_ua)};Function.prototype.pbind=function(){var a=Array.prototype.slice.call(arguments);return a.unshift(window),this.bind.apply(this,a)},Function.prototype.bind=function(){var a=this,b=Array.prototype.slice.call(arguments),c=b.shift();return function(){var d=Array.prototype.slice.call(arguments);return a.apply(c,b.concat(d))}},reqs=[],res=[],function(){var a=0;window.checkTextLength=function(b,c,d,e,f){if(a!=c.length){a=c.length;var g=replaceChars(c,e).length;g>b-100?show(d):hide(d),g>b?d.innerHTML=getLang("text_exceeds_symbol_limit",g-b):g>b-100?d.innerHTML=getLang("text_N_symbols_remain",b-g):d.innerHTML=""}},window.replaceChars=function(a,b){for(var c="",d=0;d<a.length;d++){var e=a.charCodeAt(d);switch(e){case 38:c+="&amp;";break;case 60:c+="&lt;";break;case 62:c+="&gt;";break;case 34:c+="&quot;";break;case 13:c+="";break;case 10:c+=b?"\t":"<br>";break;case 33:c+="&#33;";break;case 39:c+="&#39;";break;default:c+=e>128&&e<192||e>1280?"&#"+e+";":a.charAt(d)}}return c}}();var reqs={},ls={_init:function(){return void 0!==window.localStorage&&void 0!==window.JSON},set:function(a,b){this.remove(a);try{return!!ls._init()&&localStorage.setItem(a,JSON.stringify(b))}catch(a){return!1}},get:function(a){if(!ls._init())return!1;try{return JSON.parse(localStorage.getItem(a))}catch(a){return!1}},remove:function(a){try{localStorage.removeItem(a)}catch(a){}},flush:function(){try{localStorage.clear()}catch(a){}}},KEY=window.KEY={LEFT:37,UP:38,RIGHT:39,DOWN:40,DEL:8,TAB:9,RETURN:13,ENTER:13,ESC:27,PAGEUP:33,PAGEDOWN:34,SPACE:32,CTRL:17,BACKSPACE:8},eventExpand="EV"+Now(),eventUUID=0,eventCache={},eventDebugMode=!1,eventOut={_o:[],_n:[],get:function(a){var b;for(b=0;b<this._o.length&&this._o[b]!=a;b++);return!!this._n[b]&&this._n[b]},set:function(a,b){var c=this.prepare(a,b);return this._o.push(b),this._n.push(c),c},del:function(a){var b;for(b=0;b<this._n.length&&this._n[b]!=a;b++);this._o[b]&&delete this._o[b],this._n[b]&&delete this._n[b]},prepare:function(a,b){if(isFunction(b))return function(c){var d=function(a,e){a!==e&&(e.parentNode?d(a,e.parentNode):b(c))};d(a,getTarget(c))}}};!function(){var a=!1,b=!1,c=[];window.onDomReady=function(b){e(),a?b.call(document):c.push(function(){b.call(document)})};var d=function(){if(!a&&(a=!0,c)){var b=c;for(b.reverse();handle=b.pop();)handle.apply(document);c=null}},e=function(){b||(b=!0,document.addEventListener&&!browser.opera&&document.addEventListener("DOMContentLoaded",d,!1),browser.msie&&window==top&&function(){if(!a){try{document.documentElement.doScroll("left")}catch(a){return void setTimeout(arguments.callee,0)}d()}}(),browser.opera&&document.addEventListener("DOMContentLoaded",function(){a||d()},!1),browser.safari&&!function(){if(!a)return"loaded"!=document.readyState&&"complete"!=document.readyState?void setTimeout(arguments.callee,0):void d()}(),window.addEventListener?window.addEventListener("load",d,!1):window.attachEvent&&window.attachEvent("onload",d))}}(),onDomReady(function(){window.headNode=geByTag1("head"),extend(window,{icoNode:geByTag1("link",headNode),bodyNode:geByTag1("body"),htmlNode:geByTag1("html")}),"devicePixelRatio"in window&&2==window.devicePixelRatio&&addClass(bodyNode,"is_2x"),supportsSvg()||addClass(bodyNode,"no_svg"),browser.chrome?addClass(bodyNode,"ch"):browser.mozilla?addClass(bodyNode,"ff"):browser.safari_mobile?addClass(bodyNode,"sfm"):browser.safari&&addClass(bodyNode,"sf")});var Fx={Transitions:{linear:function(a,b,c,d){return c*a/d+b},sineInOut:function(a,b,c,d){return-c/2*(Math.cos(Math.PI*a/d)-1)+b},halfSine:function(a,b,c,d){return c*Math.sin(Math.PI*(a/d)/2)+b},easeOutBack:function(a,b,c,d){var e=1.70158;return c*((a=a/d-1)*a*((e+1)*a+e)+1)+b},easeInCirc:function(a,b,c,d){return-c*(Math.sqrt(1-(a/=d)*a)-1)+b},easeOutCirc:function(a,b,c,d){return c*Math.sqrt(1-(a=a/d-1)*a)+b},easeInQuint:function(a,b,c,d){return c*(a/=d)*a*a*a*a+b},easeOutQuint:function(a,b,c,d){return c*((a=a/d-1)*a*a*a*a+1)+b},easeOutCubic:function(a,b,c,d){return c*((a=a/d-1)*a*a+1)+b},swiftOut:function(a,b,c,d){return c*cubicBezier(.4,0,.22,1,a/d,4/d)+b}},Attrs:[["height","marginTop","marginBottom","paddingTop","paddingBottom"],["width","marginLeft","marginRight","paddingLeft","paddingRight"],["opacity","left","top"]],Timers:[],TimerId:null},fx=Fx;Fx.Base=function(a,b,c){this.el=ge(a),this.name=c,this.options=extend({onComplete:function(){},transition:Fx.Transitions.sineInOut,duration:500},b||{})},each({slideDown:genFx("show",1),slideUp:genFx("hide",1),slideToggle:genFx("toggle",1),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(a,b){window[a]=function(a,c,d){return animate(a,b,c,d)}}),Fx.Base.prototype={start:function(a,b){function c(a){return d.step(a)}this.from=a,this.to=b,this.time=Now(),this.isTweening=!0;var d=this;return c.el=this.el,c()&&Fx.Timers.push(c)&&!Fx.TimerId&&(Fx.TimerId=setInterval(function(){for(var a=Fx.Timers,b=0;b<a.length;b++)a[b]()||a.splice(b--,1);a.length||(clearInterval(Fx.TimerId),Fx.TimerId=null)},13)),this},stop:function(a){for(var b=Fx.Timers,c=b.length-1;c>=0;c--)b[c].el==this.el&&(a&&b[c](!0),b.splice(c,1));this.isTweening=!1},step:function(a){var b=Now();if(!a&&b<this.time+this.options.duration){this.cTime=b-this.time,this.now={};for(p in this.to)if(isArray(this.to[p])){var c,d=[];for(c=0;c<3;c++)d.push(Math.min(parseInt(this.compute(this.from[p][c],this.to[p][c])),255));this.now[p]=d}else this.now[p]=this.compute(this.from[p],this.to[p]);return this.update(),!0}return setTimeout(this.options.onComplete.bind(this,this.el),10),this.now=extend(this.to,this.options.orig),this.update(),this.options.hide&&hide(this.el),this.isTweening=!1,!1},compute:function(a,b){var c=b-a;return this.options.transition(this.cTime,a,c,this.options.duration)},update:function(){for(var a in this.now)isArray(this.now[a])?setStyle(this.el,a,"rgb("+this.now[a].join(",")+")"):void 0!=this.el[a]?this.el[a]=this.now[a]:setStyle(this.el,a,this.now[a])},cur:function(a,b){return null==this.el[a]||this.el.style&&null!=this.el.style[a]?parseFloat(getStyle(this.el,a,b))||0:this.el[a]}};var ajax={badbrowser:"/badbrowser.php",isFormDataSupport:void 0!==window.FormData,_init:function(){var a=!1;try{if(a=new XMLHttpRequest)return void(ajax._req=function(){return new XMLHttpRequest})}catch(a){}each(["Msxml2.XMLHTTP","Microsoft.XMLHTTP"],function(){try{var b=""+this;if(a=new ActiveXObject(b))return function(a){ajax._req=function(){return new ActiveXObject(a)}}(b),!1}catch(a){}}),ajax._req||browser.search_bot||location.replace(ajax.badbrowser)},_getreq:function(){return ajax._req||ajax._init(),ajax._req()},_post:function(a,b,c,d){var e=ajax._getreq();e.onreadystatechange=function(){if(4==e.readyState){var a=!(e.status>=200&&e.status<300);c&&c(e.responseText,a,e)}};try{e.open("POST",a,!0)}catch(a){return!1}return d||(e.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),e.setRequestHeader("X-Requested-With","XMLHttpRequest")),e.send(b),e},_get:function(a,b){var c=ajax._getreq();c.onreadystatechange=function(){if(4==c.readyState){var a=!(c.status>=200&&c.status<300);b&&b(c.responseText,a,c)}};try{c.open("GET",a,!0)}catch(a){return!1}return c.setRequestHeader("X-Requested-With","XMLHttpRequest"),c.send(""),c},plainpost:function(a,b,c,d){"string"!=typeof b?ajx2q(b):b;return ajax._post(a,b,c,d)},post:function(a,b,c){var d=!1,e=b,f=function(a,b,d){var e=parseJSON(a);!e||b?(a={error:!0,message:"global-error",traceback:a},b=!0):a=e,c&&c(a,b,d)};return"string"!=typeof b&&(d=ajax.checkDataFile(b),e=d?ajax.createFormData(b):ajx2q(b)),ajax._post(a,e,f,d)},get:function(a,b,c){var d="string"!=typeof b?ajx2q(b):b;return d&&(a+=~a.indexOf("?")?"&":"?",a+=d),ajax._get(a,c)},parseRes:function(r){var res=r.replace(/^[\s\n]+/g,"");if("<noscript>"==res.substr(0,10))try{var arr=res.substr(10).split("</noscript>");return eval(arr[0]),arr[1]}catch(a){console.log("eval ajax script:"+a.message)}return r},isInput:function(a){return"[object HTMLInputElement]"===Object.prototype.toString.call(a)},checkDataFile:function(a){if(!isObject(a)||!ajax.isFormDataSupport)return!1;for(var b in a)if(ajax.isInput(a[b])&&"files"in a[b]&&a[b].files.length>0)return!0;return!1},createFormData:function(a){var b=new FormData;for(var c in a)ajax.isInput(a[c])&&"files"in a[c]&&a[c].files.length>0?b.append(c,a[c].files[0]):b.append(c,a[c]);return b}},JsonpCallbackRegister={};if(!lang)var lang={};lang["global-yes"]="Да",lang["global-no"]="Нет",lang["global-search"]="Поиск",lang["global-save"]="Сохранить",lang["global-close"]="Закрыть",lang["global-loading"]="Загрузка",lang["qsearch-popular-hints"]="Страницы, которые Вы недавно посещали:",lang["qsearch-no-search-result"]="Поиск не дал результатов",lang["qsearch-connectiong-error"]="Ошибка соединения с сервером",lang.text_exceeds_symbol_limit=["","Допустимый объем превышен на %s знак.","Допустимый объем превышен на %s знака.","Допустимый объем превышен на %s знаков."],lang.text_N_symbols_remain=["","Остался %s знак.","Осталось %s знака.","Осталось %s знаков."];var cookies={cookies:null,set:function(a,b,c){if(this.cookies||this.init(),this.cookies[a]=b,c){var d=new Date;d.setTime(d.getTime()+24*c*60*60*1e3);var e="; expires="+d.toGMTString()}else var e="";document.cookie=a+"="+b+e+"; path=/"},get:function(a){return this.cookies||this.init(),this.cookies[a]},init:function(){this.cookies={};for(var a=document.cookie.split(";"),b=0;b<a.length;b++){var c=a[b].split("=");2==c.length&&(this.cookies[c[0].match(/^[\s]*([^\s]+?)$/i)[1]]=c[1].match(/^[\s]*([^\s]+?)$/i)[1])}}};if(void 0===window._ui){var _ui={_guid:0,_sel:!1,_uids:[!1],reg:function(a){return _ui._uids.push(a),++_ui._guid},sel:function(a){if(void 0!==a){var b=_ui.selobj();b&&b._blur&&b._blur(),_ui._sel=a}return _ui._sel},selobj:function(a){return _ui._sel&&void 0!==a&&(_ui._uids[_ui._sel]=a),_ui._uids[_ui._sel]}};addEvent(document,"keypress keydown mousedown",function(a){if(_ui.sel()){var b=_ui.selobj();if(!b)return _ui.sel(!1);if(b.container&&b.container!=ge(b.container.id))return _ui.selobj(!1),_ui.sel(!1);b.onEvent(a)}})}extend(UiControl.prototype,{CSS:{},defaultOptions:null,dom:{},__construct__:function(a){return(!this.beforeInit||this.beforeInit.apply(this,a)!==!1)&&((!this.initOptions||this.initOptions.apply(this,a)!==!1)&&(this.init.apply(this,a)!==!1&&((!this.initDOM||this.initDOM.apply(this,a)!==!1)&&(this.initEvents&&this.initEvents.apply(this,a),this.afterInit&&this.afterInit.apply(this,a),this))))},beforeInit:null,initOptions:null,init:null,initDOM:null,initEvents:null,afterInit:null,show:null,hide:null}),extend(UiUtil.prototype,{defaultOptions:null,__components:{},__cid:0,storage:null,__construct__:function(a){return this.beforeInit&&this.beforeInit.apply(this,a),this.initOptions&&this.initOptions.apply(this,a),this.init.apply(this,a),this.initEvents&&this.initEvents.apply(this,a),this.afterInit&&this.afterInit.apply(this,a),this.__components[(this.componentName?this.componentName:this.__className)+this.__cid++]=this,this},beforeInit:null,initOptions:null,init:null,initEvents:null,afterInit:null}),extend(JsClass.prototype,{defaultOptions:null,__construct__:function(a){return this.beforeInit&&this.beforeInit.apply(this,a),this.initOptions&&this.initOptions.apply(this,a),this.init.apply(this,a),this.initEvents&&this.initEvents.apply(this,a),this.afterInit&&this.afterInit.apply(this,a),this},beforeInit:null,initOptions:null,init:null,initEvents:null,afterInit:null}),createUiClass("MessageBox",{defaultOptions:{type:"MESSAGE",hideOnOutClick:!1,title:!1,width:410,dark:!1,height:"auto",bodyStyle:"",flat_buttons:!0,closeButton:!1,fullPageLink:"",returnHidden:!0,closeEsc:!0,onShow:function(){},onHide:function(){},onLoadError:function(){},onLoad:!1},beforeInit:function(){window._message_boxes||(window._message_box_guid=0,window._message_boxes=[],window._message_box_shown=0,window._doc_block_timeout=null,window._doc_blocked=!1),this.guid=++_message_box_guid},bgLayer:function(){ge("box_layer_bg")||(window.box_layer_bg=ce("div",{id:"box_layer_bg",className:this.options.dark?"dark":""},{height:getSize(document)[1]}),addEvent(window,"resize",function(){box_layer_bg.style.height=getSize(document)[1]+"px"}),onDomReady(function(){bodyNode.appendChild(box_layer_bg)})),ge("layer_wrap")||(window.layer_wrap=ce("div",{id:"layer_wrap"},{height:windowHeight()}),addEvent(window,"resize",function(){layer_wrap.style.height=windowHeight()+"px"}),onDomReady(function(){bodyNode.appendChild(layer_wrap)}))},initOptions:function(a){this.options=extend({},this.defaultOptions,a),this.options.type="POPUP"==this.options.type?"POPUP":"MESSAGE"},init:function(a){this.buttonsCount=0,this.boxContainer=null,this.boxLayout=null,this.boxTitle=null,this.boxBody=null,this.boxControls=null,this.closeButton=null,this.fullPageLink=null,this.isVisible=!1,this.hiddenBox=null,this.closeButton=null,this.fullPageLink=null,this.bgLayer()},setCloseButton:function(){if(!this.boxContainer||this.closeButton)return!1;var a=this;return this.closeButton=ce("div",{className:"box_x_button"}),this.fullPageLink?this.boxTitle.parentNode.insertBefore(this.closeButton,this.fullPageLink):this.boxTitle.parentNode.insertBefore(this.closeButton,this.boxTitle),addEvent(this.closeButton,"click",function(){a.hide()}),!0},setFullPageLink:function(){return!(!this.boxContainer||""==this.options.fullPageLink)&&(this.fullPageLink?(this.fullPageLink.href=this.options.fullPageLink,!0):(this.fullPageLink=ce("a",{className:"box_full_page_link",href:this.options.fullPageLink}),this.boxTitle.parentNode.insertBefore(this.fullPageLink,this.boxTitle),!0))},initDOM:function(a){var b=this.options;this.boxContainer=ce("div",{className:"popup_box_container",innerHTML:'<div class="box_layout"><div class="box_title_wrap cf"><div class="box_title"></div></div><div class="box_body box_progress" style="'+b.bodyStyle+'"></div><div class="box_controls_wrap"><div class="box_controls cf"></div></div></div>'},{display:"none"}),this.boxLayout=geByClass1("box_layout",this.boxContainer),this.boxTitle=geByClass1("box_title",this.boxContainer),this.boxBody=geByClass1("box_body",this.boxContainer),this.boxControls=geByClass1("box_controls",this.boxContainer),window.layer_wrap&&(window.layer_wrap.appendChild(this.boxContainer),"MESSAGE"==b.type&&(b.closeButton&&this.setCloseButton(),b.fullPageLink&&this.setFullPageLink()),this.refreshBox())},refreshBox:function(){var a=this,b=this.options,c=function(){a.hide()},d=function(b){b.keyCode==KEY.ESC&&a.hide()};this.boxTitle.innerHTML=b.title,this.boxContainer.style.width="string"==typeof b.width?b.width:b.width+"px",this.boxContainer.style.height="string"==typeof b.height?b.height:b.height+"px",removeClass(this.boxContainer,"box_no_controls"),removeClass(this.boxContainer,"message_box"),removeEvent(layer_wrap,"click",c),removeEvent(document,"keydown",d),b.hideOnOutClick&&addEvent(layer_wrap,"click",function(a){"layer_wrap"==getTarget(a).id&&c()}),b.closeEsc&&addEvent(document,"keydown",d),addClass(this.boxContainer,"POPUP"==b.type?"box_no_controls":"message_box")},removeButtons:function(){var a=[],b=this;return this.buttonsCount=0,each(this.boxControls.childNodes,function(b,c){c&&(removeEvent(c),a.push(c))}),each(a,function(){b.boxControls.removeChild(this)}),this},addButton:function(a){if(this.buttonsCount++,a=a||{},a=extend({label:"Button"+this.buttonsCount,style:this.options.flat_buttons?"flat_button":"button_blue"},a),this.options.flat_buttons){"button_no"==a.style&&(a.style="flat_button secondary"),"button_yes"==a.style&&(a.style="flat_button");var b=ce("button",{id:"button"+this.guid+"_"+this.buttonsCount,innerHTML:a.label,className:a.style+" "+(a.left?"fl":"fr")});return this.boxControls.appendChild(b),createButton(b,a.onClick),b}"button_no"==a.style&&(a.style="button_gray"),"button_yes"==a.style&&(a.style="button_blue");var c=ce("div",{className:a.style+" "+(a.left?"fl":"fr"),innerHTML:'<button id="button'+this.guid+"_"+this.buttonsCount+'">'+a.label+"</button>"});return this.boxControls.appendChild(c),createButton(c.firstChild,a.onClick),c.firstChild},addControlsText:function(a){a=a||"";var b=ce("div",{className:"controls_wrap",innerHTML:a});return this.boxControls.appendChild(b),b},content:function(a){return a=a||"",this.boxBody.innerHTML=a,removeClass(this.boxBody,"box_progress"),this.refreshCoord(),this},loadContent:function(url,params,evaluate,loader_style,noloader){var st=loader_style?loader_style:"";noloader||(this.boxBody.innerHTML='<div class="box_loader" style="'+st+'"></div>'),params=params||{};var self=this;return ajax.post(url,params,function(responseText,isFail){if(isFail)self.onLoadError("Request error occured.");else{if(evaluate)try{var result=eval("("+responseText+")");self.boxBody.innerHTML=result.html?result.html:"",result.script&&(window.execScript?window.execScript(result.script):eval.call(window,result.script))}catch(a){return self.onLoadError(responseText)}else self.boxBody.innerHTML=responseText;self.refreshCoord(),removeClass(self.boxBody,"box_progress"),isFunction(self.options.onLoad)&&self.options.onLoad(responseText)}}),this},onLoadError:function(a){this.boxBody.innerHTML="Error: "+a,this.removeButtons(),this.addButton({label:getLang("global-close"),onClick:this.hide}),removeClass(this.boxBody,"box_progress"),this.refreshCoord(),isFunction(this.options.onLoadError)&&this.options.onLoadError(a)},show:function(){if(!this.isVisible){if(this.isVisible=!0,this.hiddenBox=0,_message_box_shown&&_message_boxes[_message_box_shown].isVisible){var a=_message_boxes[_message_box_shown];this.options.returnHidden?(this.hiddenBox=_message_box_shown,a.hideContainer()):a.hide()}return _message_box_shown||(box_layer_bg.className=this.options.dark?"dark":"",bodyNode.style.overflow="hidden",htmlNode.style.overflow="hidden",addClass(bodyNode,"layers_shown"),clearTimeout(_doc_block_timeout),_doc_blocked||(_doc_blocked=!0)),show(this.boxContainer),this.refreshCoord(),_message_box_shown=this.guid,this.options.onShow&&this.options.onShow(),this}},hide:function(){if(this.isVisible){this.isVisible=!1,hide(this.boxContainer);var a=!1;return this.options.returnHidden&&this.hiddenBox&&(_message_boxes[this.hiddenBox].showContainer(),_message_box_shown=this.hiddenBox,a=!0),a||(_message_box_shown=0,bodyNode.style.overflow="auto",htmlNode.style.overflow="auto",removeClass(bodyNode,"layers_shown"),clearTimeout(_doc_block_timeout),_doc_blocked&&(_doc_block_timeout=setTimeout(function(){_doc_blocked=!1},50))),this.options.onHide&&this.options.onHide(),this}},setOptions:function(a){this.options=extend(this.options,a);var b=this;if("bodyStyle"in a)for(var c=this.options.bodyStyle.split(";"),d=0;d<c.length;++d){var e=c[d].split(":");e.length>1&&e[0].length&&(b.boxBody.style[trim(e[0])]=trim(e[1]),b.boxBody.style.setProperty&&b.boxBody.style.setProperty(trim(e[0]),trim(e[1]),""))}return this.options.closeButton&&this.setCloseButton(),this.options.fullPageLink&&this.setFullPageLink(),this.refreshBox(),this.refreshCoord(),this},hideContainer:function(){this.isVisible=!1,hide(this.boxContainer)},showContainer:function(){this.isVisible=!0,show(this.boxContainer)},refreshCoord:function(){var a=windowHeight(),b=getSize(this.boxContainer)[1],c=getScroll()[1];this.boxContainer.style.marginTop=(a<b?40:(a-b)/3)+"px",ge("layer_wrap").style.top=c+"px"},afterInit:function(){_message_boxes[this.guid]=this}});var winBoxes={},balloon_global_permit=!1,MESSAGE_ERROR="error",MESSAGE_SUCCESS="success",MESSAGE_INFO="info",MESSAGE_NOTIFY=MESSAGE_INFO,MESSAGE_CONFIRM="confirm";createChildClass("Selector",UiControl,{CSS:{},defaultOptions:{selectedItems:[],defaultItems:[],multiselect:!0,multinostop:!1,autocomplete:!0,dropdown:!0,maxItems:50,selectFirst:!0,dividingLine:"smart",resultField:void 0,customField:void 0,enableCustom:!1,valueForCustom:-1,width:300,height:250,resultListWidth:0,progressBar:!1,imageId:void 0,noImageSrc:"/images/question_s.gif",hrefPrefix:"id",noBlur:!1,zeroDefault:!1,customArrow:!1,customArrowWidth:0,big:!1,placeholder:"",placeholderColor:"#777777",placeholderColorBack:"#AFB8C2",zeroPlaceholder:!1,introText:"Start typing",disabledText:"",noResult:"Nothing found",cacheLength:100,indexkeys:void 0,onShow:void 0,onHide:void 0,onChange:void 0,onTagAdd:void 0,onTagRemove:void 0,onItemSelect:void 0,onTokenSelected:void 0,customSearch:!1,chooseFirst:!1,maxItemsShown:function(a){return a>6?500:a>4?200:a>2?150:100},highlight:function(a,b){a=b.indexOf(" ")==-1?a.split(" "):[a];var c="",d=parseLatin(b);null!==d&&(b=escapeRE(b)+"|"+escapeRE(d));var e=new RegExp("(?![^&;]+;)(?!<[^<>]*)((\\(*)("+b+"))(?![^<>]*>)(?![^&;]+;)","gi");for(var f in a)c+=(f>0?" ":"")+a[f].replace(e,"$2<em>$3</em>");return c},formatResult:function(a){return a[1]+("string"==typeof a[2]?" <span>"+a[2]+"</span>":"")},lastOptionWithoutCommaAtEnd:!1},controlName:"Selector",beforeInit:function(a){if(null===a||a.autocomplete){try{console.error("Can't init ",a)}catch(a){}return!1}this.guid=_ui.reg(this)},initOptions:function(a,b,c){this.options=extend({},this.defaultOptions,{resultField:a.name||"selectedItems",customField:a.name?a.name+"_custom":"selectedItems_custom"},this.prepareOptionsText(c||{})),this.options.highlight=this.options.highlight||function(a){return a},!isArray(this.options.selectedItems)&&isEmpty(this.options.selectedItems)&&(this.options.selectedItems=[]),a.value&&!this.options.selectedItems.length&&(this.options.selectedItems=a.value),this.options.width=parseInt(this.options.width)>0?parseInt(this.options.width):this.defaultOptions.width,this.options.height=parseInt(this.options.height)>0?parseInt(this.options.height):this.defaultOptions.height,this.options.resultListWidth=parseInt(this.options.resultListWidth)>0?parseInt(this.options.resultListWidth):this.options.width,this.options.imageId&&(this.options.imageId=ge(this.options.imageId))},init:function(a,b){this.disableSomeFeatures=0===location.pathname.indexOf("/join"),this.dataURL="string"==typeof b?b:null,this.dataItems=isArray(b)?b:[],this.currentList=this.dataItems,this.dataURL?this.cache=new Cache(this.options):this.indexer=new Indexer(this.dataItems,{indexkeys:this.options.indexkeys}),this._selectedItems=[],this.input=a,this.disabled=!1,this.mouseIsOver=!1,this.hasFocus=0,this.scrollbarWidth=0,this.timeout=null,this.readOnly=this.options.autocomplete?"":'readonly="true"',this.requestTimeout=null,this.selectedTokenId=0,this.selectorWidth=this.options.width},initDOM:function(a,b){var c=this;this.container=ce("div",{id:"container"+this.guid,className:"selector_container"+(c.options.autocomplete?"":" dropdown_container")+(c.options.big?" big":"")+(browser.mobile?" mobile_selector_container":""),innerHTML:'<table cellspacing="0" cellpadding="0" class="selector_table">                  <tr>                    <td class="selector">                      <div class="placeholder_wrap1">                        <div class="placeholder_wrap2">                          <div class="placeholder_content"></div>                          <div class="placeholder_cover"></div>                        </div>                      </div>                      <span class="selected_items"></span>                      <input type="text" class="selector_input" '+this.readOnly+' />        <input type="hidden" name="'+c.options.resultField+'" id="'+c.options.resultField+'" value="" class="resultField">        <input type="hidden" name="'+c.options.customField+'" id="'+c.options.customField+'" value="" class="customField">      </td>'+(c.options.dropdown?'<td id="dropdown'+this.guid+'" class="selector_dropdown">&nbsp;</td>':"")+'    </tr>  </table>  <div class="results_container">    <div class="result_list" style="display:none;"></div>    <div class="result_list_shadow">      <div class="shadow1"></div>      <div class="shadow2"></div>    </div>  </div>'},{width:c.options.width+"px"}),a.parentNode.replaceChild(this.container,a),each({selector:"selector",resultList:"result_list",resultListShadow:"result_list_shadow",input:"selector_input",placeholder:"placeholder_wrap1",placeholderContent:"placeholder_content",selectedItemsContainer:"selected_items",resultField:"resultField",customField:"customField",dropdownButton:"selector_dropdown"},function(a,b){c[a]=geByClass(b,c.container)[0]}),browser.chrome&&(this.resultList.style.opacity=1),a.autocomplete="1",c.options.dividingLine&&addClass(this.resultList,"dividing_line"),this.resultList.style.width=this.resultListShadow.style.width=c.options.resultListWidth+"px",this.options.dropdown&&this.initDropdown(),this.updatePlaceholder(),this.select=new Select(this.resultList,this.resultListShadow,{selectFirst:c.options.selectFirst,height:c.options.height,onItemActive:function(a){c.showImage(a),c.activeItemValue=a},onItemSelect:c._selectItem.bind(c),onShow:function(){_ui.sel(c.guid),c.highlightInput(!0),isFunction(c.options.onShow)&&c.options.onShow()},onHide:function(){_ui.sel(!1),c.highlightInput(!1),isFunction(c.options.onHide)&&c.options.onHide()}})},initEvents:function(){var a=this;this.options.dropdown&&this.initDropdownEvents();var b=browser.opera||browser.mozilla?"keypress":"keydown",c=browser.opera?"keypress":"keydown";this.onEvent=function(d){if("mousedown"==d.type){for(var e=!0,f=d.target;f&&f!=f.parentNode;){if(f==a.container){e=!1;break}f=f.parentNode}e&&(a.select.hide(),a.deselectTokens())}d.type==b&&a.handleKeyboardEventOutside(d),d.type==c&&a.select.handleKeyEvent(d)},this.disableSomeFeatures?addEvent(this.input,"paste keypress keydown focus blur",this.handleKeyboardEvent,!1,{self:this}):addEvent(this.input,"keydown keypress change paste cut drop input focus blur",this.handleKeyboardEvent,!1,{self:this}),addEvent(this.selector,"mousedown",function(b){for(var c=!1,d=b.target;null!==d;){if(hasClass(d,"token")){c=!0;break}d=d.parentNode}return!!c||a.onInputClick(b)},!1,{self:this})},afterInit:function(){this.updateInput();var a=this;if(void 0!==this.options.selectedItems)if(isArray(this.options.selectedItems))for(var b in this.options.selectedItems)this._selectItem(this.options.selectedItems[b],!1);else each((this.options.selectedItems+"").split(","),function(b,c){a._selectItem(c,!1)});this._selectedItems.length||this.options.autocomplete||this.options.multiselect||!this.options.defaultItems.length||this._selectItem(this.options.defaultItems[0],!1)},prepareOptionsText:function(a){return each(["disabledText","placeholder"],function(){this in a&&(a[this]=winToUtf(stripHTML(a[this])))}),a},fadeButtonToColor:function(){if(!this.options.customArrow&&!this.options.big){var a=window.is_rtl?{backgroundColor:"#E1E8ED",borderRightColor:"#D2DBE0"}:{backgroundColor:"#E1E8ED",borderLeftColor:"#D2DBE0"},b=this;animate(this.dropdownButton,a,200,function(){b.mouseIsOver||(b.select.isVisible()?b.dropdownButton.style.backgroundColor=b.dropdownButton.style[window.is_rtl?"borderRightColor":"borderLeftColor"]="":b.fadeButtonToWhite())})}},fadeButtonToWhite:function(){if(!this.options.customArrow&&!this.options.big){var a=this;animate(this.dropdownButton,{backgroundColor:"#FFFFFF",borderLeftColor:"#FFFFFF"},200,function(){a.dropdownButton.style.backgroundColor=a.dropdownButton.style[window.is_rtl?"borderRightColor":"borderLeftColor"]="",a.mouseIsOver&&a.fadeButtonToColor()})}},initDropdown:function(){this.scrollbarWidth=this.options.customArrowWidth||this.options.big&&25||window.sbWidth(),this.scrollbarWidth<=3&&(this.scrollbarWidth=browser.mobile?20:14),this.options.customArrow||(this.dropdownButton.style.width=this.scrollbarWidth+"px"),this.selectorWidth-=this.scrollbarWidth},initDropdownEvents:function(){var a=this;addEvent(this.dropdownButton,"mouseover",function(){addClass(this,"selector_dropdown_hover")}),addEvent(this.dropdownButton,"mouseout",function(){removeClass(this,"selector_dropdown_hover")}),addEvent(this.container,"mouseover",function(b){a.mouseIsOver=!0,a.disabled||a.fadeButtonToColor()}),addEvent(this.container,"mouseout",function(){a.mouseIsOver=!1,a.disabled||setTimeout(function(){a.mouseIsOver||(a.select.isVisible()?a.dropdownButton.style.backgroundColor=a.dropdownButton.style[window.is_rtl?"borderRightColor":"borderLeftColor"]="":a.fadeButtonToWhite())},0)}),addEvent(this.dropdownButton,"mousedown",function(){a.select.isVisible()?a.select.toggle():a.showDefaultList()})},destroyDropdown:function(){cleanElems(this.dropdownButton),removeEvent(this.container,"mouseover"),removeEvent(this.container,"mouseout"),this.scrollbarWidth=0,this.selectorWidth=this.options.width},destroy:function(){if(!this.destroyed){this.destroyDropdown();var a=ge(this.options.imageId);a&&removeEvent(a,"click"),this.select.destroy(),cleanElems(this.container,this.input,this.selector,this.resultList,this.resultListShadow,this.placeholderContent);for(var b=this.selectedItemsContainer.firstChild;b;b=b.nextSibling)cleanElems(b,b.firstChild.nextSibling);this.destroyed=!0}},updateInput:function(){if(!this.options.autocomplete&&this.options.multiselect&&this._selectedItems.length)hide(this.input);else{isVisible(this.input)||show(this.input),this.input.style.width="20px";var a=this.options.big?12:9,b=this._selectedItems.length?this.input.offsetLeft:window.is_rtl?this.selectorWidth-a:0,c=window.is_rtl?b:this.selectorWidth-b-a;this.input.style.width=Math.max(20,c)+"px"}this.updatePlaceholder()},updatePlaceholder:function(){if(!this.disableSomeFeatures){var a="0"==this.resultField.value&&this.options.zeroPlaceholder,b=this.disabled&&this.options.disabledText?this.options.disabledText:this.options.placeholder,c=this.hasFocus?this.options.placeholderColorBack:this.options.placeholderColor,d=(a||this.disabled)&&this.options.placeholderColor||"#000",e=!(this._selectedItems.length&&this.options.multiselect||this.input.value.length||a);
b!==this.placeholderTextPrev&&(this.placeholderContent.innerHTML=b),c!==this.placeholderColorPrev&&animate(this.placeholderContent,{color:c},200),d!==this.placeholderInputColorPrev&&(this.input.style.color=d),e!==this.placeholderVisiblePrev&&toggle(this.placeholder,e),this.placeholderTextPrev=b,this.placeholderColorPrev=c,this.placeholderInputColorPrev=d,this.placeholderVisiblePrev=e}},handleKeyboardEvent:function(a){var b=a.data.self;switch(a.type){case"paste":case"cut":case"drop":case"input":clearTimeout(b.timeout),b.timeout=setTimeout(function(){b.onChange()},0);break;case"keypress":if(a.which==KEY.RETURN&&browser.opera&&b.options.enableCustom&&(null===b.select.selectedItem()||void 0===b.select.selectedItem()))return b.select.hide(),b.options.noBlur?isFunction(b.options.onChange)&&(b.updateCustom(),b.options.onChange(b.resultField.value)):b.input.blur(),!1;(a.which==KEY.SPACE||a.which>40&&!a.metaKey)&&(clearTimeout(b.timeout),b.timeout=setTimeout(function(){b.onChange()},0));break;case"keydown":switch(a.keyCode){case KEY.DOWN:if(!b.select.isVisible())return setTimeout(b.showDefaultList.bind(b),0),!1;break;case KEY.DEL:if(b.input.value.length>0)clearTimeout(b.timeout),b.timeout=setTimeout(b.onChange.bind(b),0);else{if(b.selectedTokenId){for(var c=0,d=b._selectedItems.length-2;d>=0;d--)b._selectedItems[d][0]==b.selectedTokenId&&b._selectedItems[d+1]&&(c=b._selectedItems[d+1][0]);b.removeTagData(b.selectedTokenId),c?b.selectToken(c):b.readOnly||setTimeout(function(){b.input.focus()},0)}else b.hasFocus&&b._selectedItems.length&&b.selectToken(b._selectedItems[b._selectedItems.length-1][0]);cancelEvent(a)}return!0;case KEY.RETURN:if(!browser.opera&&b.options.enableCustom&&(null===b.select.selectedItem()||void 0===b.select.selectedItem()))return b.select.hide(),b.options.noBlur?isFunction(b.options.onChange)&&(b.updateCustom(),b.options.onChange(b.resultField.value)):b.input.blur(),!1;break;case KEY.ESC:b.input.blur()}break;case"focus":if(b.disabled||b.select.isVisible()||b.focusSelf||b.showDefaultList(),b.focusSelf=!1,b.disabled||b.readOnly)return b.input.blur(),!0;(0==b._selectedItems.length||b.options.multiselect)&&(browser.mozilla?setTimeout(function(){b.input.value=""},0):b.input.value=""),addClass(b.input,"focused"),b.input.style.color="#000",b.hasFocus++,b.updatePlaceholder();break;case"blur":if(isFunction(b.options.chooseFirst)&&b.options.chooseFirst(b.input.value))return b.select.active=0,isFunction(b.select.options.onItemSelect)&&b.select.options.onItemSelect(b.select.selectedItem(),void 0,!0),cancelEvent(a);if(b.readOnly)return!0;b.disabled||(b.updateCustom(),clearTimeout(b.requestTimeout),b.changeAfterBlur&&isFunction(b.options.onChange)&&(b.options.enableCustom&&b._selectedItems.length||b.options.onChange(""),b.changeAfterBlur=!1),b.options.onBlur&&b.options.onBlur()),removeClass(b.input,"focused"),b.hasFocus=0,b.updatePlaceholder()}return!0},updateCustom:function(){var a=this;if(a.options.enableCustom&&a.input.value.length){var b=a.input.value;0==a._selectedItems.length&&(a.resultField.value=parseInt(!a.options.valueForCustom),a.customField.value=b,a._selectItem([a.options.valueForCustom,b]))}else 0==a._selectedItems.length?a.input.value="":a.options.multiselect&&(a.input.value="");a.updatePlaceholder()},handleKeyboardEventOutside:function(a){var b;if(this.disabled||this.input.value.length>0&&this.hasFocus||!this.hasFocus&&0==this.selectedTokenId)return!0;switch(a.keyCode){case KEY.RETURN:return!1;case KEY.LEFT:for(b=this._selectedItems.length-1;b>=0;b--)if(!this.selectedTokenId||this._selectedItems[b][0]==this.selectedTokenId&&b>0){this.selectedTokenId&&b--,this.selectToken(this._selectedItems[b][0]),this.input.blur();break}return!1;case KEY.RIGHT:for(b=0;b<this._selectedItems.length;b++)if(this._selectedItems[b][0]==this.selectedTokenId){b<this._selectedItems.length-1?(this.selectToken(this._selectedItems[b+1][0]),this.input.blur()):this.readOnly||(this.deselectTokens(),this.input.focus());break}return!1}return!0},onInputClick:function(a){var b=a.data.self;b.deselectTokens(),b.select.isVisible()?b.input.readOnly?(b.focusSelf=!0,b.select.toggle()):b.onChange():b.showDefaultList(),b.readOnly?b.input.blur():b.input.focus()},highlightInput:function(a){a?addClass(this.container,"selector_focused"):removeClass(this.container,"selector_focused")},selectToken:function(a){this.options.multiselect&&(this.select.hide(),removeClass(ge("bit_"+this.guid+"_"+this.selectedTokenId),"token_selected"),addClass(ge("bit_"+this.guid+"_"+a),"token_selected"),this.selectedTokenId=a,isFunction(this.options.onTokenSelected)&&this.options.onTokenSelected(a),this.showImage(a))},deselectTokens:function(){this.selectedTokenId&&this.options.multiselect&&(removeClass(ge("bit_"+this.guid+"_"+this.selectedTokenId),"token_selected"),this.selectedTokenId=0,isFunction(this.options.onTokenSelected)&&this.options.onTokenSelected(),this.showImage())},_blur:function(){this.select.hide()},showImage:function(a,b){if(!this.options.imageId)return!1;var c=ge(this.options.imageId);if(!c)return!1;if(void 0===b){a||(a=this.resultField.value.split(",")[0]);var d=this._selectedItems.concat(this.currenDataItems);if(d&&d.length)for(var e in d)if(d[e]&&d[e][0]==a){b=d[e];break}}return void 0!==b&&"string"==typeof b[3]&&b[3].length?"none"==b[3]?c.style.display="none":(c.style.display="",c.setAttribute("src",b[3]),c.parentNode.href="/"+this.options.hrefPrefix+b[0],removeEvent(c.parentNode,"click")):(c.style.display="",c.setAttribute("src",this.options.noImageSrc),c.parentNode.href="#",addEvent(c.parentNode,"click",function(){return!0})),!0},_selectItem:function(a,b,c){if(null!==a&&void 0!==a){void 0===b&&(b=!0);var d;if(a==-2e9)d=[this.curTerm,this.curTerm,cur.lang.mail_enter_email_address,"/images/contact_info.png",0,""];else if("string"==typeof a&&a.indexOf("@")!=-1)d=[a,a,cur.lang.mail_enter_email_address,"/images/contact_info.png",0,""];else if("object"==typeof a)d=a;else{var e=[];each([this.dataItems,this.options.defaultItems,this.receivedData],function(a,b){b&&b.length&&(e=e.concat(b))});for(var f in e)if(e[f][0]==a||e[f]==a){d=e[f];break}}if("object"!=typeof d&&(d=[a,a]),d[0]=d[0].toString(),d[1]=d[1].toString(),this.changeAfterBlur=!1,d[0]===this.resultField.value)return void(this.options.multiselect||(this.input.value=winToUtf(stripHTML(d[1])),this.showImage(),!this.input.value.length&&this.options.placeholder||addClass(this.input,"selected"),this.updatePlaceholder()));if(this._selectedItems.length>=this.options.maxItems)return void this.select.hide();this.deselectTokens(),this.addTagData(d),this.showImage(),this.options.multiselect?(this.input.value="",this.dataURL?this.select.clear():this.select.removeItem(d[0])):(this.input.value=winToUtf(stripHTML(d[1])),addClass(this.input,"selected"),this.updatePlaceholder()),this.select.hide(),this.updateInput(),c&&this.options.multiselect&&!this.readOnly?setTimeout(function(){this.options.multinostop||(this.focusSelf=!0),hide(this.input),show(this.input),this.input.focus()}.bind(this),100):this.options.noBlur||this.input.blur(),b&&(this.options.multiselect&&isFunction(this.options.onTagAdd)&&this.options.onTagAdd(d,this.resultField.value),isFunction(this.options.onChange)&&this.options.onChange(this.resultField.value))}},addTagData:function(a){if(a&&!(a.length<2)){if(!this.options.multiselect)return this._selectedItems.splice(0,this._selectedItems.length,a),void(this.resultField.value=a[0]);for(var b in this._selectedItems)if(this._selectedItems[b][0]==a[0])return void this.selectToken(this._selectedItems[b][0]);this._selectedItems.push(a);var c=[];for(b in this._selectedItems)c.push(this._selectedItems[b][0]);this.resultField.value=c.join(","),this.input.style.width="1px";var d=ce("div",{id:"bit_"+this.guid+"_"+a[0],className:"token"}),e=Math.max(this.selector.clientWidth,getSize(d)[0]),f=this;d.innerHTML='<span class="l">'+a[1]+'</span><span class="x" />',addEvent(d,"click",function(){return f.selectToken(a[0]),!1}),addEvent(d,"dblclick",function(){return a[4]&&(f.removeTagData(a[0]),each(a[4],function(a,b){f._selectItem(b,!1)})),!1}),addEvent(d,"mouseover",function(b){addClass(d,"token_hover"),f.showImage(a[0],a)}),addEvent(d,"mouseout",function(a){removeClass(d,"token_hover"),f.showImage(f.activeItemValue?f.activeItemValue:f.selectedTokenId)});var g=d.firstChild.nextSibling;addEvent(g,"mousedown",function(){return f.select.hide(),f.removeTagData(a[0]),!f.readOnly&&f.hasFocus&&f.input.focus(),!1}),f.selectedItemsContainer.appendChild(d);for(var h=d.firstChild,i=h.innerHTML;d.offsetWidth>e&&i.length>3;)i=i.substr(0,i.length-2),h.innerHTML=i+"..."}},removeTagData:function(a){this.selectedTokenId=0;var b=ge("bit_"+this.guid+"_"+a);if(!b)return!1;var c=b.firstChild.nextSibling;cleanElems(b,c),b.parentNode.removeChild(b);var d,e=[];for(i in this._selectedItems)this._selectedItems[i][0]!=a?e.push(this._selectedItems[i][0]):d=i;return void 0!=d&&(this.resultField.value=e.join(","),isFunction(this.options.onTagRemove)&&this.options.onTagRemove(this._selectedItems[d],this.resultField.value),isFunction(this.options.onChange)&&this.options.onChange(this.resultField.value),this._selectedItems.splice(d,1),this.options.multiselect&&(this.defaultList=!1),this.showImage(),this.updateInput(),!1)},onChange:function(){var a=trim(this.input.value.toLowerCase());if(this.options.multiselect||(this._selectedItems.length&&(this.changeAfterBlur=!0),this._clear()),this.updatePlaceholder(),clearTimeout(this.requestTimeout),0==a.length)return void this.showDefaultList();this.curTerm=a;var b,c=isFunction(this.options.customSearch)&&this.options.customSearch(a);return c?void this.receiveData(a,c):void(this.dataURL?(b=this.cache.getData(a),null===b?this.requestTimeout=setTimeout(function(){this.request(this.receiveData.bind(this),this.showNoDataList.bind(this))}.bind(this),300):b&&b.length?this.receiveData(a,b):this.showNoDataList()):(b=this.indexer.search(a),b&&b.length?this.receiveData(a,b):this.showNoDataList()))},showNoDataList:function(){(this.hasFocus||this.readOnly)&&(this._showSelectList(this.options.noResult),this.defaultList=!1)},showDefaultList:function(){var a=hasClass(this.resultList,"reverse"),b=this.needsReverse();if(a!=b&&(this.currenDataItems&&this.setSelectContent(this.currenDataText||"",this.currenDataItems),toggleClass(this.resultList,"reverse",b),toggleClass(this.resultListShadow,"reverse",b),a=b),this.defaultList&&this.select.hasItems())this.options.multiselect||!this._selectedItems.length?this.select.show():this.select.show(this._selectedItems[0][0]);else{this.defaultList=!0;var c=this.options.autocomplete?this.options.introText:null;this._showSelectList(c,this.options.defaultItems.length||this.options.zeroDefault?this.options.defaultItems:this.dataItems)}a?(!this._selectedItems.length,setStyle(this.resultList,{bottom:getSize(this.container)[1]-1})):setStyle(this.resultList,{bottom:"auto"})},showDataList:function(a,b){this.defaultList=!1,this._showSelectList(null,a,b)},needsReverse:function(){var a,b=window.scrollGetY?scrollGetY():getScroll()[1],c=getXY(this.container)[1]||0,d=getSize(this.container)[1]||22,e=this.options.height||250,f=this.options.minHeight||0,g=(window.pageNode&&window.browser.mozilla?Math.min(getSize(pageNode)[1],window.lastWindowHeight):window.lastWindowHeight)||getScroll()[3],h=this.resultList&&this.resultList.firstChild;if(h&&h.firstChild){var i=getStyle(this.resultList,"display"),j=getStyle(this.resultList,"visibility");setStyle(this.resultList,{visibility:"hidden",display:"block"}),a=getSize(this.resultList)[1],setStyle(this.resultList,{visibility:j,display:i})}else a=f?f:this.currenDataItems?this.currenDataItems.length*getSize(this.container)[1]:e;return a>e&&(a=e),c+d+a-b>g&&c-a-b>0&&c-a>40},setSelectContent:function(a,b,c){b=isArray(b)&&b.length?b:[];var d=[];this.select.clear(),a&&d.push(["",a,!0]);var e;if(b.length){for(e in b)"object"!=typeof b[e]&&(b[e]=[b[e],b[e]]);if(this.options.multiselect&&(b=this.filterData(b)),"smart"==this.options.dividingLine){removeClass(this.resultList,"dividing_line");for(e in b)"string"==typeof b[e][2]&&b[e][2].length&&addClass(this.resultList,"dividing_line")}var f=this.options.autocomplete&&c?this.options.maxItemsShown(c.length):b.length,g=this;for(e=0;e<b.length;++e){var h=b[e];if(!f)break;var i=g.options.formatResult(h);c&&(i=g.options.highlight(i,c))&&--f,i&&d.push([h[0],i])}}a&&d.length>1&&(d=d.slice(1)),this.select.content(d)},_showSelectList:function(a,b,c){if(this.currenDataItems=b,this.currenDataText=a,window.is_rtl){var d=getXY(this.container)[0];d&&(geByClass("results_container",this.container)[0].style.left=d+"px")}return this.setSelectContent(a,b,c),this.select.hasItems()&&(this.options.multiselect||!this._selectedItems.length?this.select.show():this.select.show(this._selectedItems[0][0])),!0},receiveData:function(a,b){a==this.curTerm&&(""!==a&&b&&b.length&&this.hasFocus?(this.receivedData=b,this.showDataList(b,a)):this.select.hide())},filterData:function(a){var b=[],c=this;return each(a,function(a){for(var d in c._selectedItems)if(this[0]==c._selectedItems[d][0])return;b.push(this)}),b},request:function(success,failure){if(this.dataURL){var term=trim(this.input.value.toLowerCase()),self=this;if(0!=term.length){var sep=this.dataURL.indexOf("?")==-1?"?":"&",url=this.dataURL+sep+"str="+encodeURIComponent(term),done=function(data){self.options.progressBar&&hide(self.options.progressBar);try{data=eval("("+data+")")}catch(a){}data.length?(self.cache.setData(term,data),isFunction(success)&&success(term,data)):(self.cache.setData(term,[]),isFunction(failure)&&failure(term))};ajax.plainpost(url,{},done),this.options.progressBar&&show(this.options.progressBar)}}},doSort:function(a){var b,c,d;if(a.length&&!(a.length<2))for(b=0;b<a.length-1;b++)for(c=b+1;c<a.length;c++)a[b][1]>a[c][1]&&(d=a[b],a[b]=a[c],a[c]=d)},disable:function(a){if(a&&!this.disabled){this.disabled=!0,addClass(this.container,"disabled");var b=getSize(this.container);this.options.disabledText&&(this.input.value=""),this.container.appendChild(ce("div",{className:"hide_mask"},{position:"absolute",background:"#000",opacity:0,width:b[0]+"px",height:b[1]+"px",marginTop:-b[1]+"px"})),this.input.blur(),this.input.style.color="",this.select.hide()}else!a&&this.disabled&&(this.disabled=!1,this.options.autocomplete&&(this.input.value=""),removeClass(this.container,"disabled"),this.container.removeChild(geByClass("hide_mask",this.container)[0]));this.updatePlaceholder()},_clear:function(){return this.showImage(),this.options.multiselect&&(this.selectedTokenId=0,this.selectedItemsContainer.innerHTML="",this.defaultList=!1),this.options.multiselect||this.options.autocomplete?(removeClass(this.input,"selected"),this.resultField.value="",this._selectedItems.splice(0,this._selectedItems.length)):this._selectedItems[0]!=this.options.defaultItems[0]&&this._selectItem(this.options.defaultItems[0],!1),!1},setURL:function(a){"string"==typeof a&&(this.dataURL=a,this.cache?this.cache.flush():this.cache=new Cache(this.options),this.indexer&&delete this.indexer,this.dataItems=[])},setData:function(a){if(isArray(a)){if(this.options.autocomplete)this.dataItems=a,this.dataURL=null;else if(this.select.clear(),this.options.defaultItems=a,!this.options.multiselect)if(!this._selectedItems.length&&this.options.defaultItems.length)this._selectItem(this.options.defaultItems[0],!1);else if(this._selectedItems.length){var b=!1;for(var c in this.options.defaultItems){var d=this.options.defaultItems[c][0]||this.options.defaultItems[c];if(d==this._selectedItems[0][0]||d==this._selectedItems[0][0]){b=!0;break}}b?this._selectItem(this._selectedItems[0][0],!1):this._selectItem(this.options.defaultItems[0],!1)}this.indexer?this.indexer.setData(a):this.indexer=new Indexer(a),this.cache&&delete this.cache}},focus:function(){this.readOnly||this.input.focus()},selectItem:function(a,b){this._selectItem(a,b)},setOptions:function(a){if(a=this.prepareOptionsText(a),extend(this.options,a),"maxItems"in a&&this.options.maxItems>=0)for(var b=this._selectedItems.length-1;b>=this.options.maxItems;b--)this.removeTagData(this._selectedItems[b][0]);if("defaultItems"in a&&(this.select.clear(),this.select.isVisible(this.container)&&this.showDefaultList()),"enableCustom"in a&&this.options.enableCustom&&!this.options.autocomplete&&(this.options.autocomplete=a.autocomplete=!0),"width"in a&&(this.container.style.width=this.options.width+"px",this.resultList.style.width=this.resultListShadow.style.width=this.options.width+"px",this.selectorWidth=this.options.width-this.scrollbarWidth),"dropdown"in a){var c=geByClass("selector_dropdown",this.container)[0];!this.options.dropdown&&c?(this.destroyDropdown(),c.parentNode.removeChild(c)):!c&&this.options.dropdown&&(c=this.container.firstChild.rows[0].insertCell(1),c.id="dropdown"+this.guid,c.className="selector_dropdown",c.innerHTML="&nbsp;",this.dropdownButton=c,this.initDropdown(),this.initDropdownEvents())}"autocomplete"in a&&(this.options.autocomplete?(removeClass(this.container,"dropdown_container"),this.input.readOnly=!1,this.readOnly=""):(addClass(this.container,"dropdown_container"),this.input.readOnly=!0,this.options.enableCustom=!1,this.readOnly='readonly="true"')),("width"in a||"autocomplete"in a||"dropdown"in a||"placeholder"in a||"disabledText"in a)&&this.updateInput()},val:function(a,b){return void 0!==a&&this._selectItem(a,void 0!==b&&b),this.resultField.value},val_full:function(){return this.options.multiselect?this._selectedItems:this._selectedItems.length?this._selectedItems[0]:[this.resultField.value,this.input.value]},customVal:function(a,b){return void 0!==a&&(this.customField.value=a,this.selectItem([this.options.valueForCustom,a],void 0!==b&&b)),this.customField.value},selectedItems:function(){return this._selectedItems},clear:function(){this._clear(),this.updateInput()}}),createChildClass("Select",UiControl,{common:{_sel:window.Select&&Select._sel||[],reg:function(a){return this._sel.push(a),this._sel.length},destroy:function(a){this._sel[a-1]=!1},itemMouseMove:function(a,b,c){this._sel[a-1].onMouseMove(b,c)},itemMouseDown:function(a,b,c){this._sel[a-1].onMouseDown(b,c)}},CSS:{FIRST:"first",LAST:"last",ACTIVE:"active",SCROLLABLE:"result_list_scrollable"},controlName:"SelectList",initOptions:function(a,b,c){this.options=c||{}},init:function(a,b,c){this.container=a,this.shadow=b,this.active=-1,this.data=[],this.uid=this.common.reg(this),this.maxHeight=this.options.height?this.options.height:250},initDOM:function(){this.list=ce("ul"),this.container.appendChild(this.list)},show:function(a){var b=isVisible(this.container);b||this.performShow();var c,d;if(a){for(d=0;d<this.list.childNodes.length;d++)if(c=this.list.childNodes[d],c.getAttribute("val")==a){this.highlight(d,c);break}}else if(this.options.selectFirst){var e,f=!1;for(d=0;d<this.list.childNodes.length;d++)if(e=f?this.list.childNodes.length-1-d:d,c=this.list.childNodes[e],!c.getAttribute("dis")){this.highlight(e,c);break}}!b&&isFunction(this.options.onShow)&&this.options.onShow()},hide:function(){isVisible(this.container)&&(hide(this.container),hide(this.shadow),isFunction(this.options.onHide)&&this.options.onHide(),this.highlight(-1),isFunction(this.options.onItemActive)&&this.options.onItemActive())},handleKeyEvent:function(a){if(!isVisible(this.container))return!0;switch(a.keyCode){case KEY.UP:return this.movePosition(-1),cancelEvent(a);case KEY.DOWN:return this.movePosition(1),cancelEvent(a);case KEY.TAB:this.hide();break;case KEY.RETURN:return isFunction(this.options.onItemSelect)&&this.active>-1&&this.options.onItemSelect(this.selectedItem(),void 0,!0),cancelEvent(a),!1;case KEY.ESC:return this.hide(),!1;case KEY.PAGEUP:case KEY.PAGEDOWN:return!1}return!0},clear:function(){this.highlight(-1),this.list.innerHTML="",this.updateContainer()},destroy:function(){this.clear(),Select.destroy(this.uid)},selectedItem:function(){if(this.active>=0){var a=this.list.childNodes[this.active],b=a.getAttribute("val")||a.innerHTML;return b}},movePosition:function(a){var b=intval(this.active)+intval(a);for(b<0?this.container.scrollTop=0:b+1>this.list.childNodes.length&&(this.container.scrollTop=this.list.offsetTop+this.list.offsetHeight-this.container.offsetHeight);;){if(b+1>this.list.childNodes.length||b<0){if(this.options.cycle)break;return!1}var c=this.list.childNodes[b];if(c&&!c.getAttribute("dis"))break;b++}return this.highlight(b,this.list.childNodes[b]),!0},highlight:function(a,b){return this.active!=-1&&removeClass(this.list.childNodes[this.active],this.CSS.ACTIVE),b?(this.active=a,addClass(b,this.CSS.ACTIVE),isFunction(this.options.onItemActive)&&this.options.onItemActive(b.getAttribute("val")||b.innerHTML),void(b.offsetTop+b.offsetHeight+this.list.offsetTop>this.container.offsetHeight+this.container.scrollTop-1?this.container.scrollTop=b.offsetTop+this.list.offsetTop+b.offsetHeight-this.container.offsetHeight+1:b.offsetTop+this.list.offsetTop<this.container.scrollTop&&(this.container.scrollTop=b.offsetTop+this.list.offsetTop))):void(this.active=-1)},onMouseMove:function(a,b){return!hasClass(b,"active")&&(this.highlight(a,b),!0)},onMouseDown:function(a,b){var c=b.getAttribute("val")||b.innerHTML;isFunction(this.options.onItemSelect)&&this.options.onItemSelect(c,void 0,!0),this.hide()},updateContainer:function(){var a=this.container&&hasClass(this.container,"reverse");if(this.maxHeight<this.list.offsetHeight)this.container.style.height=this.maxHeight+"px",a?hide(this.shadow):(show(this.shadow),this.shadow.style.marginTop=this.maxHeight+1+"px"),addClass(this.container,this.CSS.SCROLLABLE);else{removeClass(this.container,this.CSS.SCROLLABLE),this.container.style.height="auto";var b=intval(this.list.offsetHeight)+intval(this.list.offsetTop);b&&!a?(show(this.shadow),this.shadow.style.marginTop=b+"px"):hide(this.shadow)}},content:function(a){var b,c,d,e,f,g,h=[],i=a.length;for(b=0;b<i;++b)c=a[b],d=c[0],e=c[1],f=c[2],g=this.uid+", "+b,d=void 0===d?"":d.toString(),e=(void 0===e?"":e.toString())||d,h.push("<li ",f?'dis="1"':'onmousemove="Select.itemMouseMove('+g+', this)" onmousedown="Select.itemMouseDown('+g+', this)"',' val="',d.replace(/&/g,"&amp;").replace(/"/g,"&quot;"),'" class="',f?"disabled ":"",b==i-1?this.CSS.LAST+" ":"",(b?"":this.CSS.FIRST)+'">',e,"</li>");return this.list.innerHTML=h.join(""),this.updateContainer(),!0},removeItem:function(a){var b,c,d=this.list.childNodes,e=d.length;if(a!==b){for(c=0;c<e;++c){var f=d[c];if(f.getAttribute("val")==a||f.innerHTML==a){f.setAttribute("dis","1"),hide(f);break}}for(c=0;c<e;++c)if(isVisible(d[c])){addClass(d[c],this.CSS.FIRST);break}for(c=e;c>0;--c)if(isVisible(d[c-1])){addClass(d[c-1],this.CSS.LAST);break}this.updateContainer()}},performShow:function(){this.list.style.position="absolute",this.list.style.visibility="hidden",show(this.container),show(this.shadow),this.updateContainer(),this.list.style.position="relative",this.list.style.visibility="visible"},isVisible:function(){return isVisible(this.container)},hasItems:function(){return this.list.childNodes.length>0},toggle:function(){this.isVisible(this.container)?this.hide():this.show()}}),createChildClass("Indexer",UiUtil,{defaultOptions:{chars:2,delimeter:/[\s\(\)\.,\-]+/},componentName:"Indexer",initOptions:function(a,b){this.options=extend({},this.defaultOptions,{indexkeys:[1]},b)},init:function(a){this.setData(a)},setData:function(a){delete this.storage,this.storage={data:clone(a),index:{}},clearTimeout(this.indexTimer),this.indexTimer=setTimeout(this.createIndex.bind(this),10)},createIndex:function(){this.storage.data.length&&(this.storage.index={},each(this.storage.data,this.indexItem.bind(this)))},indexItem:function(a,b){var c,d,e,f="",g={};for(c=0;c<this.options.indexkeys.length;c++)b[this.options.indexkeys[c]]&&(f+=" "+b[this.options.indexkeys[c]].toString().replace(this.options.delimeter," ").replace(/<[^>]*>/,""));for(f=trim(winToUtf(f).toLowerCase()).split(/\s+/),c=0;c<f.length;c++)for(d=1;d<=this.options.chars;d++)e=f[c].substr(0,d),g[e]||(g[e]=1,void 0===this.storage.index[e]&&(this.storage.index[e]=[]),this.storage.index[e].push(a))},search:function(a){a=trim(a.toLowerCase().replace(this.options.delimeter," "));var b=this;if(!a)return b.storage.data;if(a.length<=this.options.chars&&a.indexOf(" ")==-1){var c=[];return each(this.storage.index[a]||[],function(){c.push(b.storage.data[this])}),c}a=a.split(" ");var d=0,e="";each(a,function(){var a=b.storage.index[this.substr(0,b.options.chars)];return(!e||!a||a.length<d)&&(d=a?a.length:0,e=this.substr(0,b.options.chars)),!d});var f=[];return d?(each(b.storage.index[e.substr(0,b.options.chars)],function(c,d){var e,g=b.storage.data[d],h=!1,i="";for(e=0;e<b.options.indexkeys.length;e++)i+=" "+g[b.options.indexkeys[e]].replace(b.options.delimeter," ").replace("<b>","").replace("</b>","");for(i=winToUtf(i).toLowerCase(),e=0;e<a.length;e++)if(i.indexOf(" "+a[e])==-1){h=!0;break}h||f.push(g)}),f):f},flush:function(){delete this.storage}}),createChildClass("Cache",UiUtil,{defaultOptions:{cacheLength:100},componentName:"Cache",initOptions:function(a){this.options=extend({},this.defaultOptions,a)},init:function(){this.storage={},this.length=0},setData:function(a,b){this.length>this.options.cacheLength&&this.flush(),a in this.storage||this.length++,this.storage[a]=clone(b)},getData:function(a){return this.options.cacheLength&&this.length&&a in this.storage?this.storage[a]:null},flush:function(){delete this.storage,this.storage={},this.length=0}}),createChildClass("Checkbox",UiControl,{CSS:{STANDART:"checkbox_"},defaultOptions:{checkedValue:1,notCheckedValue:"",width:300,label:"checkbox",circle:!1},beforeInit:function(){this.guid=_ui.reg(this)},controlName:"CheckBox",initOptions:function(a,b){return!!a&&(this.options=extend({},this.defaultOptions,{checked:a.value,resultField:a.name||a.id||"checkbox"},b),this.options.checked=!!intval(this.options.checked),void(this.options.width=intval(this.options.width)>0?intval(this.options.width):this.defaultOptions.width))},init:function(){this.disabled=!1},initDOM:function(a,b){this.container=ce("div",{id:"container"+this.guid,className:"checkbox_container"+(this.options.circle?" checkbox_circle":""),innerHTML:'<table cellpadding=0 cellspacing=0><tr><td class="checkbox"><div class="checkbox_off"></div></td><td class="checkbox_label">'+this.options.label+'<input type="hidden" name="'+this.options.resultField+'" id="'+this.options.resultField+'" value="'+(this.options.checked?this.options.checkedValue:this.options.notCheckedValue)+'"></td></tr></table>'},{width:this.options.width+"px"}),a.parentNode.replaceChild(this.container,a),this.checkbox=geByClass("checkbox_off",this.container)[0],this.resultField=ge(this.options.resultField)},initEvents:function(){addEvent(this.container,"click mouseover mouseout",this.handleMouseEvent,!1,{self:this})},afterInit:function(){this.setState(this.options.checked,!1,!0)},destroy:function(){this.destroyed||(removeEvent(this.container,"click mouseover mouseout",this.handleMouseEvent),this.destroyed=!0)},show:function(){show(this.container)},hide:function(){hide(this.container)},handleMouseEvent:function(a){"click"==a.type?a.data.self.disabled||a.data.self.setState(!a.data.self.options.checked):(a.data.self.is_over="mouseover"==a.type,a.data.self.updateClass())},disable:function(a){a&&!this.disabled?(this.disabled=!0,addClass(this.container,"disabled")):!a&&this.disabled&&(this.disabled=!1,removeClass(this.container,"disabled"))},updateClass:function(){this.checkbox.className="checkbox_"+(this.options.checked?"on":"off")+(this.is_over?"_over":"")},setState:function(a,b,c){void 0===b&&(b=!0),void 0===c&&(c=!1),a=!!a,(this.options.checked!=a||c)&&(this.options.checked=a,this.updateClass(),this.resultField.value=this.options.checked?this.options.checkedValue:this.options.notCheckedValue,b&&isFunction(this.options.onChange)&&this.options.onChange(this.resultField.value))},setOptions:function(a){extend(this.options,a),("checked"in a||"checkedValue"in a||"notCheckedValue"in a)&&this.setState(this.options.checked,!1,!0)},checked:function(a){return void 0!==a&&this.setState(a),this.options.checked},val:function(){return this.resultField.value}}),createChildClass("Radiobutton",UiControl,{common:{_radio_buttons:{},_callbacks:{},deselect:function(a){for(var b=0;b<this._radio_buttons[a].length;++b)this._radio_buttons[a][b].checked(!1)},select:function(a,b){for(var c=0;c<this._radio_buttons[a].length;++c)if(this._radio_buttons[a][c].val()==b)return void this._radio_buttons[a][c].checked(!0)},setChangeEvent:function(a,b){isFunction(b)?this._callbacks[a]=b:delete this._callbacks[a]}},CSS:{STANDART:"radiobutton_",CONTAINER:"radiobtn_container"},defaultOptions:{checked:!1,width:300,label:"radiobutton"},controlName:"Radiobutton",beforeInit:function(){this.guid=_ui.reg(this)},initOptions:function(a,b){return!!a&&(this.options=extend({},this.defaultOptions,{value:a.value,resultField:a.name||"radiobutton"},b),this.options.checked=!!intval(this.options.checked),void(this.options.width=intval(this.options.width)>0?intval(this.options.width):this.defaultOptions.width))},init:function(){this.disabled=!1,this.is_over=!1,this.inputName=this.options.resultField},initDOM:function(a,b){this.container=ce("div",{id:"container"+this.guid,className:this.CSS.CONTAINER,innerHTML:'<table cellpadding=0 cellspacing=0><tr><td class="radiobtn"><div class="radiobtn_off"><div></div></div></td><td class="radiobtn_label">'+this.options.label+'<input type="radio" id="'+a.id+'" name="'+this.options.resultField+'" value="'+(this.options.checked?'checked="true"':"")+'"></td></tr></table>'},{width:this.options.width+"px"}),a.parentNode.replaceChild(this.container,a),this.radiobutton=geByClass("radiobtn_off",this.container)[0],this.resultField=this.container.getElementsByTagName("input")[0],this.resultField.value=this.options.value},initEvents:function(){addEvent(this.container,"click mouseover mouseout",this.handleMouseEvent,!1,{self:this})},afterInit:function(){isArray(this.common._radio_buttons[this.inputName])||(this.common._radio_buttons[this.inputName]=[]),this.common._radio_buttons[this.inputName].push(this),this.setState(this.options.checked,!1,!0)},destroy:function(){if(!this.destroyed){for(var a=0;a<this.common._radio_buttons[this.inputName].length;++a)if(this.common._radio_buttons[this.inputName][a]===this){this.common._radio_buttons[this.inputName].splice(a,1);break}this.common._radio_buttons[this.inputName].length||(delete this.common._radio_buttons[this.inputName],this.common.setChangeEvent(this.inputName)),removeEvent(this.container,"click mouseover mouseout",this.handleMouseEvent),this.destroyed=!0}},handleMouseEvent:function(a){var b=a.data.self;"click"==a.type?b.disabled||b.options.checked||b.setState(!0):(b.is_over="mouseover"==a.type,b.updateClass())},disable:function(a){a&&!this.disabled?(this.disabled=!0,addClass(this.container,"disabled")):!a&&this.disabled&&(this.disabled=!1,removeClass(this.container,"disabled"))},updateClass:function(){this.radiobutton.className="radiobtn_"+(this.options.checked?"on":"off")+(this.is_over?"_over":"")},setState:function(a,b,c){void 0===b&&(b=!0),c=c||!1,a=!!a,(this.options.checked!=a||c)&&(a&&this.common.deselect(this.inputName),this.options.checked=a,this.updateClass(),this.resultField.checked=a,b&&(this.options.checked&&isFunction(this.options.onSelect)&&this.options.onSelect(this.resultField.value),isFunction(this.options.onChange)&&this.options.onChange(this.resultField.value,a),a&&isFunction(this.common._callbacks[this.inputName])&&this.common._callbacks[this.inputName](this.resultField.value)))},setOptions:function(a){extend(this.options,a),"checked"in a&&this.setState(this.options.checked,!1)},checked:function(a){return void 0!==a&&this.setState(a),this.options.checked},val:function(){return this.resultField.value}});